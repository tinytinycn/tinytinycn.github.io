<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 01_mysql_basic · hang 's blogs</title><meta name="description" content="01_mysql_basic - hang"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/tinytinycn.github.io/favicon.png"><link rel="stylesheet" href="/tinytinycn.github.io/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://github.com/atom.xml" title="hang 's blogs"></head><body><div class="wrap"><header><a href="/tinytinycn.github.io/" class="logo-link"><img src="/tinytinycn.github.io/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/tinytinycn.github.io/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/tinytinycn.github.io/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/tinytinycn.github.io/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">01_mysql_basic</h1><div class="post-info">Jun 8, 2016</div><div class="post-content"><h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ul>
<li>mysql/mariadb 安装</li>
<li>sql 结构化查询语言</li>
<li>mysql 使用</li>
<li>数据类型</li>
<li>数据搜索引擎</li>
<li>索引</li>
<li>表之间的关系</li>
<li>事务</li>
<li>测试数据</li>
<li>数据库备份和恢复</li>
</ul>
<hr>
<h1 id="mysql-mariadb-安装"><a href="#mysql-mariadb-安装" class="headerlink" title="mysql/mariadb 安装"></a>mysql/mariadb 安装</h1><ul>
<li>安装mysql 社区版本</li>
<li>安装mariadb<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum -y install mariadb-server mariadb mariadb-devel</span><br><span class="line">systemctl start mariadb</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h1 id="sql-结构化查询语言"><a href="#sql-结构化查询语言" class="headerlink" title="sql 结构化查询语言"></a>sql 结构化查询语言</h1><ul>
<li>DDL 数据定义语言 create/drop/truncate</li>
<li>DML 数据操作语言 insert/update/delete/</li>
<li>DQL 数据查询语言 select/</li>
<li>DCL 数据控制语言 grant授权.分配权限</li>
</ul>
<h1 id="mysql-使用"><a href="#mysql-使用" class="headerlink" title="mysql 使用"></a>mysql 使用</h1><ul>
<li><p>命令行客户端:(登录)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql -h192.168.xxx.xxx -P3306 -uroot -p  //指定远程服务器,端口</span><br><span class="line">mysql -uroot -p                           //指定user用户root,密码</span><br><span class="line">password: ****</span><br></pre></td></tr></table></figure>
</li>
<li><p>其他客户端:(登录)</p>
</li>
<li><p>创建用户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">create user &apos;root&apos;@&apos;192.168.12.%&apos; identified by &apos;1234&apos;; //指定用户地址和密码</span><br><span class="line">grant all privileges on *.* to &apos;root&apos;@&apos;192.168.12.%&apos;; //授予所有权限给用户</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除用户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop user &apos;username&apos;@&apos;%&apos;  //删除用户</span><br></pre></td></tr></table></figure>
</li>
<li><p>进入数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">use test;</span><br><span class="line">use mysql3;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create database tinydb  </span><br><span class="line">create database tinydb charset=utf8;</span><br><span class="line">create database tinydb charset=gbk;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">show databases;</span><br><span class="line">show schemas;</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter database tinydb charset=gbk;  //一般只能修改数据库的字符编码</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop database tinydb;  //所有数据表全部删除,不可恢复</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create table tinytable(</span><br><span class="line">  id int,</span><br><span class="line">  name varchar(20),</span><br><span class="line">  money decimal(8,2)</span><br><span class="line">  )engine=innodb charset=utf8;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">show tables;</span><br><span class="line">desc tinytable;</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">rename table tinytable to tinytable2;            //修改表名</span><br><span class="line">alter table tinytable engine=myisam chaset=gbk;  //修改属性</span><br><span class="line"></span><br><span class="line">alter table ... add ... first        //加到第一个字段</span><br><span class="line">alter table ... add ... after        //加到某个字段之后</span><br><span class="line">alter table tinytable add id int first;  </span><br><span class="line">alter table tinytable add(                             //添加字段</span><br><span class="line">  gender char(1),</span><br><span class="line">  tel char(11)</span><br><span class="line">  );</span><br><span class="line">alter table tinytable change gender sex varchar(10);   //修改字段名</span><br><span class="line">alter table tinytable modify tel char(20);             //修改字段类型</span><br><span class="line">alert table tinytable modify tel varchar(20) after age;//修改字段顺序</span><br><span class="line">alter table tinytable drop sex;                        //删除字段</span><br><span class="line">desc tinytable;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看表中的数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user;</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop table tinytable;   //不可恢复</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h1 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h1><ul>
<li>字符串</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">char          //定长字符串,最多255字节.定长查询效率更高.</span><br><span class="line">char(20)    //定长20.若超出长度可能会报错,也可能会截断.若长度不足,补空格.</span><br><span class="line">varchar       //变长字符串,字节量总和超过65535字节报错,小于255字节加一位字节记录字符串长度,大于255字节加两位字节记录字符串长度; 另外字段允许null值,需额外1个字节记录其值.gbk编码,最长65535/2长度,uft8编码最长65535/3长度.</span><br><span class="line">varchar(12) //变长12.</span><br><span class="line">text          //65535字节,只占用表总字节量的10个字节.</span><br><span class="line">blob          //超大对象数据,使用流开读写blob字段数据.通常不用它保存文本.</span><br><span class="line">enum          //枚举</span><br><span class="line">  gender enum(&apos;F&apos;,&apos;M&apos;)</span><br><span class="line">set           //</span><br><span class="line">  funny set(&apos;lol&apos;,&apos;dota2&apos;,&apos;sc2&apos;)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>数字</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">添加 unsigned标记 表示无符号</span><br><span class="line">tinyint unsigned  //0~255</span><br><span class="line">tinyint           //-127~128</span><br><span class="line">zerofill      //位数不足,补零</span><br><span class="line">tinyint       //1字节</span><br><span class="line">smallint      //2字节</span><br><span class="line">int           //4字节</span><br><span class="line">int(3)      //括号内数字,影响显示格式,不影响数字范围,只显示3位</span><br><span class="line">int(4)</span><br><span class="line">bigint        //8字节</span><br><span class="line">float         //4字节</span><br><span class="line">double        //8字节</span><br><span class="line">double(6,2) //括号内数组,影响显示格式,不影响数字范围</span><br><span class="line">decimal/numeric</span><br><span class="line">decimal(8,2)  //括号内数字,影响数字范围,保存精确浮点数,整数位6位,小数位2位,整数位超出范围报错,小数位超出范围四舍五入.</span><br></pre></td></tr></table></figure>
</li>
<li><p>日期</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">date          //年月日</span><br><span class="line">time          //时分秒</span><br><span class="line">datetime      //年月日时分秒</span><br><span class="line">timestamp     //时间戳,同 datetime.最大到2038 年.修改一行数据时,第一个timestamp字段会自动修改为系统当前时间.(一般不使用)</span><br><span class="line">                也可以使用 bigint 整数表示时间</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h1 id="数据搜索引擎"><a href="#数据搜索引擎" class="headerlink" title="数据搜索引擎"></a>数据搜索引擎</h1><ul>
<li>innodb 默认,支持事务/外键,提供行级锁</li>
<li>myisam 不支持事务/外键,数据访问效率更高,只提供表级锁</li>
<li>memory 内存表<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">create table tb_item(</span><br><span class="line">  id bigint(20),</span><br><span class="line">  cid bigint(10),</span><br><span class="line">  brand varchar(50),</span><br><span class="line">  model varchar(50),</span><br><span class="line">  title varchar(100),</span><br><span class="line">  sell_point varchar(500),</span><br><span class="line">  price bigint,</span><br><span class="line">  num int(10),</span><br><span class="line">  barcode varchar(30),</span><br><span class="line">  image varchar(500),</span><br><span class="line">  status tinyint(4),</span><br><span class="line">  created datetime,</span><br><span class="line">  updated datetime</span><br><span class="line">  )engine=innodb charset=utf8;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h1 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h1><ul>
<li>数据存储位置目录:B-Tree,哈希索引</li>
<li>提高查询效率,首先考虑创建索引<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">create index index_name on tb(name);     -- 创建索引</span><br><span class="line">create index index_name on tb(name,addr);</span><br><span class="line">show create table tb\G;                  -- 查看索引</span><br><span class="line">alter table tb drop index index_name;    -- 删除索引</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h1 id="表之间的关系"><a href="#表之间的关系" class="headerlink" title="表之间的关系"></a>表之间的关系</h1><p>一对一</p>
<ul>
<li>具有唯一约束unique的外键约束</li>
<li>既是主键,也是外键的字段</li>
</ul>
<p>一对多</p>
<ul>
<li>在多方添加外键</li>
</ul>
<p>多对多</p>
<ul>
<li>需要一个中间表,添加两个外键字段,分别引用两张表的主键</li>
</ul>
<h1 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h1><p>innodb 支持事务</p>
<ul>
<li>原子性</li>
<li>一致性</li>
<li>隔离性</li>
<li>持久性</li>
</ul>
<h1 id="测试数据"><a href="#测试数据" class="headerlink" title="测试数据"></a>测试数据</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;  source d:\hr_mysql.sql</span><br></pre></td></tr></table></figure>

<h1 id="数据库备份和恢复"><a href="#数据库备份和恢复" class="headerlink" title="数据库备份和恢复"></a>数据库备份和恢复</h1><ul>
<li><p>备份(window命令行执行)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -uroot -p --default-character-set=utf8</span><br><span class="line">  数据库名&gt;d:\a\backup.sql</span><br></pre></td></tr></table></figure>
</li>
<li><p>恢复(提前新建一个新空库在服务器)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">drop database if exists jtds;</span><br><span class="line">create database jtds charset=utf8;    -- 建库</span><br><span class="line"></span><br><span class="line">mysql -uroot -p --default-character-set=utf8 数据库名&lt;d:\a\backup.sql</span><br></pre></td></tr></table></figure>

</li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/tinytinycn.github.io/2016/06/09/02-mysql-DML/" class="prev">上一篇</a><a href="/tinytinycn.github.io/2016/04/18/01-java-多线程/" class="next">下一篇</a></div><div class="copyright"><p>© 2015 - 2019 <a href="http://github.com">hang</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>