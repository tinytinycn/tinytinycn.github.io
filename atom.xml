<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>hang &#39;s blogs</title>
  
  
  <link href="/tinytinycn.github.io/atom.xml" rel="self"/>
  
  <link href="http://github.com/"/>
  <updated>2019-09-22T09:32:28.235Z</updated>
  <id>http://github.com/</id>
  
  <author>
    <name>hang</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>django-01-基础</title>
    <link href="http://github.com/2019/03/27/django-03-%E5%9F%BA%E7%A1%80/"/>
    <id>http://github.com/2019/03/27/django-03-基础/</id>
    <published>2019-03-27T08:41:25.000Z</published>
    <updated>2019-09-22T09:32:28.235Z</updated>
    
    <content type="html"><![CDATA[<h2 id="django-03"><a href="#django-03" class="headerlink" title="django 03"></a>django 03</h2><h3 id="数据库配置"><a href="#数据库配置" class="headerlink" title="数据库配置"></a>数据库配置</h3><p>编辑 YOUR-PROJECT/settings.py (一个包含django项目设置的python模块)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Database</span></span><br><span class="line"><span class="comment"># https://docs.djangoproject.com/en/2.1/ref/settings/#databases</span></span><br><span class="line"></span><br><span class="line">DATABASES = &#123;</span><br><span class="line">    <span class="string">'default'</span>: &#123;</span><br><span class="line">        <span class="string">'ENGINE'</span>: <span class="string">'django.db.backends.mysql'</span>,</span><br><span class="line">        <span class="string">'NAME'</span>: <span class="string">'test_django'</span>,</span><br><span class="line">        <span class="string">'USER'</span>: <span class="string">'root'</span>,</span><br><span class="line">        <span class="string">'PASSWORD'</span>: <span class="string">'123456'</span>,</span><br><span class="line">        <span class="string">'HOST'</span>: <span class="string">'127.0.0.1'</span>,</span><br><span class="line">        <span class="string">'PORT'</span>: <span class="string">'3306'</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="时区配置"><a href="#时区配置" class="headerlink" title="时区配置"></a>时区配置</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Internationalization</span></span><br><span class="line"><span class="comment"># https://docs.djangoproject.com/en/2.1/topics/i18n/</span></span><br><span class="line"></span><br><span class="line">LANGUAGE_CODE = <span class="string">'en-us'</span></span><br><span class="line"></span><br><span class="line">TIME_ZONE = <span class="string">'Asia/Shanghai'</span></span><br><span class="line"></span><br><span class="line">USE_I18N = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">USE_L10N = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">USE_TZ = <span class="literal">True</span></span><br></pre></td></tr></table></figure><h3 id="应用配置"><a href="#应用配置" class="headerlink" title="应用配置"></a>应用配置</h3><p>默认激活了一些应用，但并不是每个人都需要它们。如果你不需要某个或某些应用，你可以在运行 migrate 前毫无顾虑地从 INSTALLED_APPS 里注释或者删除掉它们。 migrate 命令只会为在 INSTALLED_APPS 里声明了的应用进行数据库迁移</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Application definition</span></span><br><span class="line"></span><br><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="string">'polls.apps.PollsConfig'</span>,      //自己的应用在此注册</span><br><span class="line">    <span class="string">'django.contrib.admin'</span>,        //管理员站点， 你很快就会使用它</span><br><span class="line">    <span class="string">'django.contrib.auth'</span>,         //认证授权系统</span><br><span class="line">    <span class="string">'django.contrib.contenttypes'</span>, //内容类型框架</span><br><span class="line">    <span class="string">'django.contrib.sessions'</span>,     //会话框架</span><br><span class="line">    <span class="string">'django.contrib.messages'</span>,     //消息框架</span><br><span class="line">    <span class="string">'django.contrib.staticfiles'</span>,  //管理静态文件的框架</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h3 id="数据库迁移"><a href="#数据库迁移" class="headerlink" title="数据库迁移"></a>数据库迁移</h3><ul><li>前提: 取决于YOUR-PROJECT/settings.py设置文件和各个应用的数据库迁移文件YOUR-APP/migrations/**.py</li><li>执行: <code>python manage.py migrate</code></li></ul><h3 id="创建模型"><a href="#创建模型" class="headerlink" title="创建模型"></a>创建模型</h3><p>编辑 YOUR-APP/models.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Question</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    question_text = models.CharField(max_length=<span class="number">200</span>)</span><br><span class="line">    pub_date = models.DateTimeField(<span class="string">'date published'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Choice</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    question = models.ForeignKey(Question, on_delete=models.CASCADE)</span><br><span class="line">    choice_text = models.CharField(max_length=<span class="number">200</span>)</span><br><span class="line">    votes = models.IntegerField(default=<span class="number">0</span>)</span><br></pre></td></tr></table></figure><h3 id="激活模型"><a href="#激活模型" class="headerlink" title="激活模型"></a>激活模型</h3><ol><li><p>YOUR-PROJECT/settings.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="string">'polls.apps.PollsConfig'</span>, //注册应用, 点式路径 <span class="string">'YOUR-APP.apps.类名'</span></span><br><span class="line">    <span class="string">'django.contrib.admin'</span>,</span><br><span class="line">    <span class="string">'django.contrib.auth'</span>,</span><br><span class="line">    <span class="string">'django.contrib.contenttypes'</span>,</span><br><span class="line">    <span class="string">'django.contrib.sessions'</span>,</span><br><span class="line">    <span class="string">'django.contrib.messages'</span>,</span><br><span class="line">    <span class="string">'django.contrib.staticfiles'</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure></li><li><p>执行 <code>python manage.py makemigrations polls</code>, 检测模型文件models.py的修改, 生成模型迁移文件在<br>YOUR-APP/migrations/0001_initial.py</p></li><li><p>执行 <code>python manage.py migrate</code>, 迁移所有还没执行过的迁移(跟踪django_migrations表看执行过哪些迁移)</p></li><li><p>开发过程中, 可以平滑升级数据库而不丢失数据;</p></li></ol><ul><li>编辑models.py, 修改模型;</li><li>运行<code>python manage.py makemigrations</code>, 为模型的改变生成迁移文件;</li><li>运行<code>python manage.py migrate</code>, 应用数据库迁移;</li></ul><h3 id="初试api"><a href="#初试api" class="headerlink" title="初试api"></a>初试api</h3><p>执行<code>python manage.py shell</code>, 会设置 DJANGO_SETTINGS_MODULE 环境变量，这个变量会让 Django 根据 mysite/settings.py 文件来设置 Python 包的导入路径;</p><h3 id="创建管理页面"><a href="#创建管理页面" class="headerlink" title="创建管理页面"></a>创建管理页面</h3><ul><li>执行<code>python manage.py createsuperuser</code></li><li>执行<code>python manage.py runserver</code></li><li>访问<code>http://127.0.0.1:8000/admin/</code></li></ul><h3 id="管理页面添加对象"><a href="#管理页面添加对象" class="headerlink" title="管理页面添加对象"></a>管理页面添加对象</h3><ul><li><p>编辑YOUR-APP/admin.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Question</span><br><span class="line"></span><br><span class="line">admin.site.register(Question)</span><br></pre></td></tr></table></figure></li><li><p>重新进入管理页面</p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;django-03&quot;&gt;&lt;a href=&quot;#django-03&quot; class=&quot;headerlink&quot; title=&quot;django 03&quot;&gt;&lt;/a&gt;django 03&lt;/h2&gt;&lt;h3 id=&quot;数据库配置&quot;&gt;&lt;a href=&quot;#数据库配置&quot; class=&quot;header
      
    
    </summary>
    
    
      <category term="django" scheme="http://github.com/categories/django/"/>
    
    
  </entry>
  
  <entry>
    <title>django-02-mysql</title>
    <link href="http://github.com/2019/03/26/django-02-mysql/"/>
    <id>http://github.com/2019/03/26/django-02-mysql/</id>
    <published>2019-03-26T02:41:25.000Z</published>
    <updated>2019-09-22T09:32:47.749Z</updated>
    
    <content type="html"><![CDATA[<h2 id="django-02"><a href="#django-02" class="headerlink" title="django 02"></a>django 02</h2><h3 id="整合mysql"><a href="#整合mysql" class="headerlink" title="整合mysql"></a>整合mysql</h3><ul><li>django 支持MySQL5.6及以上;</li><li>django 希望数据库支出unicode(utf-8编码)以及任务事务执行和引用完整;</li><li>注意, MySQL使用MyIsam引擎时, 不强制执行事务和完整引用;</li><li>注意, MySQL使用默认InnoDB引擎时, 自增计数器在MySQL重启时会被丢失, 从而使用”max(id)+1”, 这样会导致 AutoField字段值被重用;</li><li>注意, MySQL使用MyIsam引擎, 不支持事务和强制外键约束;</li></ul><h3 id="安装mysqlclient-推荐"><a href="#安装mysqlclient-推荐" class="headerlink" title="安装mysqlclient(推荐)"></a>安装mysqlclient(推荐)</h3><p>参考: <a href="https://pypi.org/project/mysqlclient/" target="_blank" rel="noopener">https://pypi.org/project/mysqlclient/</a></p><ul><li>django 要求mysqlclient 1.3.7及以上;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install default-libmysqlclient-dev</span><br><span class="line">sudo apt install python3-dev</span><br><span class="line"></span><br><span class="line">pip3 install mysqlclient //install from pypi 或者在 requirements.txt中指定版本</span><br></pre></td></tr></table></figure></li></ul><h3 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h3><ul><li><p>确保数据库的所有table和columns使用默认utf-8编码;<br><code>create database &lt;dbname&gt; character set utf8;</code></p></li><li><p>MySQL默认使用 <code>utf8_general_ci</code> 排序规则; 数据库以不区分大小写的方式进行所有字符串相等的比较. 也就是说, 在数据库级别上, “Fred”和”freD”被认为是平等的. 如果您希望对特定的列或表进行区分大小写的比较, 更改列或表以使用 <code>utf8_bin</code> 排序规则; 另外, 使用<code>utf8_general_ci</code> 速度更快,但会有少量错误的可能, 若不能接收, 可以使用<code>utf8_unicode_ci</code>确保更准确;</p></li><li><p>模型formsets 校验是大小写敏感的; <code>Model formsets validate unique fields in a case-sensitive manner. Thus when using a case-insensitive collation, a formset with unique field values that differ only by case will pass validation, but upon calling save(), an IntegrityError will be raised.</code> </p></li></ul><h3 id="连接数据库"><a href="#连接数据库" class="headerlink" title="连接数据库"></a>连接数据库</h3><ul><li>连接配置优先级顺序:</li></ul><ol><li>OPTIONS</li><li>NAME,USER,PASSWORD,HOST,PORT</li><li>mysql option files</li></ol><ul><li>样例:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//settings.py</span><br><span class="line">DATABASES = &#123;</span><br><span class="line">    &apos;default&apos;: &#123;</span><br><span class="line">        &apos;ENGINE&apos;: &apos;django.db.backends.mysql&apos;,</span><br><span class="line">        &apos;OPTIONS&apos;: &#123;</span><br><span class="line">            &apos;read_default_file&apos;: &apos;/path/to/my.cnf&apos;,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//mysql.cnf</span><br><span class="line">database = NAME</span><br><span class="line">user = USER</span><br><span class="line">password = PASSWORD</span><br><span class="line">default-character-set = utf8</span><br></pre></td></tr></table></figure></li></ul><h3 id="隔离级别"><a href="#隔离级别" class="headerlink" title="隔离级别"></a>隔离级别</h3><ul><li>django 2.0 默认使用repeatable read , 不不是django1.x 之前的read committed;</li></ul><h3 id="数据库默认引擎"><a href="#数据库默认引擎" class="headerlink" title="数据库默认引擎"></a>数据库默认引擎</h3><ul><li><p>alter table<br><code>ALTER TABLE &lt;tablename&gt; ENGINE=INNODB;</code></p></li><li><p>init_command</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&apos;OPTIONS&apos;: &#123;</span><br><span class="line">   &apos;init_command&apos;: &apos;SET default_storage_engine=INNODB&apos;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="表名"><a href="#表名" class="headerlink" title="表名"></a>表名</h3><ul><li>建议使用小写表名, 避免一些问题;</li></ul><h3 id="特殊字段的注意事项"><a href="#特殊字段的注意事项" class="headerlink" title="特殊字段的注意事项"></a>特殊字段的注意事项</h3><ul><li><p>Character fields, 若使用unique=True时, varchar 的最大长度max_length限制为255字符;</p></li><li><p>TextField, MySQL只能索引BLOB或Text列的前n个字符. 由于TextField没有定义的长度，所以不能将其标记为unique=True.<code>MySQL will report: &quot;BLOB/TEXT column &#39;&lt;db_column&gt;&#39; used in key specification without a key length&quot;.</code></p></li><li><p>如果数据库包含 TIMESTAMP列, 必须使用 USE_TZ=False,避免数据出错; 如果启用时区支持，MySQL和Django都将尝试将值从UTC转换为本地时间.</p></li><li><p><code>Row locking with QuerySet.select_for_update()</code> MySQL does not support the NOWAIT, SKIP LOCKED, and OF options to the SELECT … FOR UPDATE statement. If select_for_update() is used with nowait=True, skip_locked=True, or of then a NotSupportedError is raised.</p></li><li><p>自动类型转换, 当在查询一个字符串类型的的值, 使用一个整型值作为查询条件时, MySQL会强制将所有的值转换成integer进行比较. 例如, table中有’abc’,’def’, 查询条件where mycolumn=0, 这两行将与之匹配; 同样where mycolumn=1 将与’abc1’匹配; 若你实现的自定义模型直接继承Field, 覆盖get_prep_value()或使用RawSQL(),extra(),raw(), 你应该确保正确的类型转换;</p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;django-02&quot;&gt;&lt;a href=&quot;#django-02&quot; class=&quot;headerlink&quot; title=&quot;django 02&quot;&gt;&lt;/a&gt;django 02&lt;/h2&gt;&lt;h3 id=&quot;整合mysql&quot;&gt;&lt;a href=&quot;#整合mysql&quot; class=&quot;he
      
    
    </summary>
    
    
      <category term="django" scheme="http://github.com/categories/django/"/>
    
    
  </entry>
  
  <entry>
    <title>python-13-virtualenv</title>
    <link href="http://github.com/2019/03/25/python-13-virtualenv/"/>
    <id>http://github.com/2019/03/25/python-13-virtualenv/</id>
    <published>2019-03-25T07:53:41.000Z</published>
    <updated>2019-09-22T09:27:11.093Z</updated>
    
    <content type="html"><![CDATA[<h2 id="virtualenv"><a href="#virtualenv" class="headerlink" title="virtualenv"></a>virtualenv</h2><p>virtualenv 提供隔离的python运行环境, 解决不同应用间多版本的冲突问题;</p><ul><li><p>pip3安装virtualenv到python3版本下包中<br><code>pip3 install virtualenv</code></p></li><li><p>创建一个项目的独立虚拟环境</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkdir tinyproject</span><br><span class="line">cd tinyproject</span><br><span class="line">virtualenv --no-site-packages venv //不复制系统python的所有第三方包, 最新版本默认使用此参数, 可以不用写出来</span><br><span class="line">source venv/bin/activate //进入虚拟环境</span><br><span class="line">pip --version //虚拟环境的pip版本</span><br><span class="line">pip install django //安装第三方包至虚拟环境的下</span><br><span class="line">deactivate //退出虚拟环境</span><br></pre></td></tr></table></figure></li><li><p>移除虚拟环境</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">deactivate</span><br><span class="line">rm -r /path/to/ENV  //例如: rm -r tinyproject/venv</span><br></pre></td></tr></table></figure></li><li><p>可选参数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">virtualenv --system-site-packages ENV //继承系统已安装第三方包</span><br></pre></td></tr></table></figure></li><li><p>更多<br><code>https://virtualenv.pypa.io/en/latest/</code></p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;virtualenv&quot;&gt;&lt;a href=&quot;#virtualenv&quot; class=&quot;headerlink&quot; title=&quot;virtualenv&quot;&gt;&lt;/a&gt;virtualenv&lt;/h2&gt;&lt;p&gt;virtualenv 提供隔离的python运行环境, 解决不同应用间多版本
      
    
    </summary>
    
    
      <category term="python" scheme="http://github.com/categories/python/"/>
    
    
  </entry>
  
  <entry>
    <title>python-12-常用内建模块</title>
    <link href="http://github.com/2018/09/20/python-12-%E5%B8%B8%E7%94%A8%E5%86%85%E5%BB%BA%E6%A8%A1%E5%9D%97/"/>
    <id>http://github.com/2018/09/20/python-12-常用内建模块/</id>
    <published>2018-09-20T08:33:41.000Z</published>
    <updated>2019-09-22T09:26:36.212Z</updated>
    
    <content type="html"><![CDATA[<h3 id="datetime日期时间"><a href="#datetime日期时间" class="headerlink" title="datetime日期时间"></a>datetime日期时间</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">from datetime import datetime</span><br><span class="line"></span><br><span class="line">now=datetime.now()                # 获取当前时间</span><br><span class="line">dt=datetime(2018, 09, 15, 12, 12) # 指定时间</span><br><span class="line">ts=dt.timestamp()                 # datetime类型 &gt; timestamp时间戳(注意:浮点数,小数为代表毫秒数)</span><br><span class="line">dt2=datetime.fromtimestamp(ts)    # timestamp时间戳 &gt; datetime类型</span><br><span class="line">dt3=datetime.utcfromtimestamp(t)  # timestamp时间戳 &gt; UTC时间</span><br><span class="line">dt4=datetime.strptime(&apos;2018-09-15 12:12:12&apos;, &apos;%Y-%m-%d %H:%M:%S&apos;) # str &gt; datetime类型</span><br><span class="line">dt5=datetime.now()</span><br><span class="line">dt5.strftime(&apos;%a, %b %d %H:%M&apos;) //Fri, Sep 15 12:12 datetime类型 &gt; str</span><br></pre></td></tr></table></figure><ul><li><p>日期计算</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from datetime import datetime, timedelta</span><br><span class="line"></span><br><span class="line">now=datetime.now()</span><br><span class="line">now+timedelta(hours=10)</span><br><span class="line">now-timedelta(days=1)</span><br><span class="line">now+timedelta(days=2, hours=12)</span><br></pre></td></tr></table></figure></li><li><p>创建时区</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">from datetime import datetime, timedelta, timezone</span><br><span class="line"></span><br><span class="line">tz_utc_8=timezone(timedelat(hours=8)) # 创建UTC+8:00时区</span><br><span class="line">now=datetime.now()</span><br><span class="line">dt=now.replace(tzinfo=tz_utc_8)       # 为dt强制设置一个时区</span><br></pre></td></tr></table></figure></li><li><p>时区转换</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">utc_dt=datetime.utcnow().replace(tzinfo=timezone.utc)  # 获取utc时间, 强制设置为UTC+0:00时区</span><br><span class="line">bj_dt=utc_dt.astimezone(timezone(timedelta(hours=8))) # 转换成UTC+8:00时区对应时间</span><br><span class="line">dj_dt=utc_dt.astimezone(timezone(timedelta(hours=9))) # 转换成UTC+9:00时区对应时间</span><br><span class="line">dj_dt=bj_dt.astimezone(timezone(timedelta(hours=9))) # UTC+8:00 &gt; UTC+9:00</span><br></pre></td></tr></table></figure></li></ul><h3 id="collections集合"><a href="#collections集合" class="headerlink" title="collections集合"></a>collections集合</h3><ul><li><p>nametuple(‘名称’, [属性list])函数, 创建一个自定义tuple对象</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from collections import namedtuple</span><br><span class="line"></span><br><span class="line">point=namedtuple(&apos;point&apos;, [&apos;x&apos;,&apos;y&apos;])</span><br><span class="line">p=point(1,2)</span><br><span class="line">p.x //1</span><br><span class="line">p.y //2</span><br></pre></td></tr></table></figure></li><li><p>deque高效实现插入删除的双向列表, 适合队列和堆栈</p></li><li><p>deque除了实现list的append()/pop()函数, 还支持appendleft()/popleft()函数从头部添加删除元素</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import collections import deque</span><br><span class="line"></span><br><span class="line">q=deque([&apos;a&apos;,&apos;b&apos;,&apos;c&apos;])</span><br><span class="line">q.append(&apos;x&apos;)</span><br><span class="line">q.appendleft(&apos;y&apos;)</span><br><span class="line">q //[&apos;y&apos;,&apos;a&apos;,&apos;b&apos;,&apos;c&apos;,&apos;x&apos;]</span><br></pre></td></tr></table></figure></li><li><p>defaultdict()函数实现不存在key对应元素时,支持默认返回值</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from collections import defaultdict</span><br><span class="line"></span><br><span class="line">dd=defaultdict(lambda:&apos;N/A&apos;)</span><br><span class="line">dd[&apos;k1&apos;]=&apos;abc&apos;</span><br><span class="line">dd[&apos;k1&apos;] //&apos;abc&apos;</span><br><span class="line">dd[&apos;k2&apos;] //不存在, 返回默认值&apos;N/A&apos;</span><br></pre></td></tr></table></figure></li><li><p>OrderedDict()函数实现保持key顺序元素</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from collections import OrderedDict</span><br><span class="line"></span><br><span class="line">od=OrderedDict([(&apos;a&apos;,1),(&apos;b&apos;,2),(&apos;c&apos;,3)])</span><br><span class="line">od //保持key的有序性</span><br><span class="line">od[&apos;d&apos;]=4</span><br><span class="line">od[&apos;c&apos;]=3</span><br><span class="line">od.keys() //[&apos;a&apos;, &apos;b&apos;, &apos;d&apos;, &apos;c&apos;] 注意: 当插入新key时, 总是根据插入时的顺序保持key的排序位置</span><br></pre></td></tr></table></figure></li><li><p>Counter()计数器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from collections import Counter</span><br><span class="line"></span><br><span class="line">c=Counter()</span><br><span class="line">for ch in &apos;python&apos;:</span><br><span class="line">    c[ch]=c[ch]+1</span><br><span class="line"></span><br><span class="line">c //实际上, Counter是dict子类</span><br></pre></td></tr></table></figure></li></ul><h3 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h3><ul><li>Base64一种用64个字符标志任意二进制数据的方法(把3个字节二进制变成4个字节字符串, 不足3倍末尾补\x00, 在编码后末尾加=或==)<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line"></span><br><span class="line">base64.b64encode(b&apos;binary\x00string&apos;) //YmluYXJ5AHN0cmluZw==</span><br><span class="line">base64.b64decode(b&apos;YmluYXJ5AHN0cmluZw==&apos;) //b&apos;binary\x00string&apos;</span><br></pre></td></tr></table></figure></li></ul><h3 id="hashlib"><a href="#hashlib" class="headerlink" title="hashlib"></a>hashlib</h3><ul><li>摘要算法又称哈希算法,散列算法, 通过一个函数, 讲任意长度的数据转换为一个长度固定的数据串(通常用16进制的字符串表示)<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line"></span><br><span class="line">md5 = hashlib.md5()</span><br><span class="line">md5.update(&apos;hello, world&apos;.encode(&apos;utf-8&apos;))</span><br><span class="line">print(md5.hexdigest())</span><br><span class="line"></span><br><span class="line">md55=hashlib.md5()</span><br><span class="line">md55.update(&apos;hello,&apos;.encode(&apos;utf-8&apos;))</span><br><span class="line">md55.update(&apos; world&apos;.encode(&apos;utf-8&apos;))</span><br><span class="line">print(md55.hexdigest())</span><br><span class="line"></span><br><span class="line">sha1=hashlib.sha1()</span><br><span class="line">sha1.update(&apos;hello, world&apos;.encode(&apos;utf-8&apos;))</span><br><span class="line">print(sha1.hexdigest())</span><br></pre></td></tr></table></figure></li></ul><h3 id="hmac"><a href="#hmac" class="headerlink" title="hmac"></a>hmac</h3><ul><li>内置模块实现了标准的Hmac算法，它利用一个key对message计算“杂凑”后的hash，使用hmac算法比标准hash算法更安全，因为针对相同的message，不同的key会产生不同的hash<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import hmac</span><br><span class="line"></span><br><span class="line">message = b&apos;hello, world.&apos;</span><br><span class="line">key = b&apos;secret&apos;</span><br><span class="line">h = hmac.new(key, message, digestmod=&apos;MD5&apos;) //随机key, 注意使用的bytes类型</span><br><span class="line">print(h.hexdigest())</span><br></pre></td></tr></table></figure></li></ul><h3 id="itertools"><a href="#itertools" class="headerlink" title="itertools"></a>itertools</h3><ul><li>Python的内建模块itertools提供了非常有用的用于操作迭代对象的函数<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import itertools</span><br><span class="line"></span><br><span class="line">natuals=itertools.count(1) //创建一个无限迭代器</span><br><span class="line">cs=itertools.cycle(&apos;abc&apos;)  //创建一个无限循环一个序列的迭代器</span><br><span class="line">ns=itertools.repeat(&apos;A&apos;, 3) //创建一个无限重复一个序列的迭代器, 第二个参数可以限定重复次数</span><br><span class="line">ns=itertools.takewhile(lambda x:x&lt;=10, natuals) //截取一个有限的序列</span><br><span class="line">list(ns)</span><br><span class="line">for c in itertools.chain(&apos;abc&apos;, &apos;xyz&apos;):  //串联两个序列, 创建一个迭代器</span><br><span class="line">    print(c)</span><br><span class="line">for key, group in itertools.groupby(&apos;AAABBBCCC&apos;): //迭代器中相同元素分组</span><br><span class="line">    print(key, list(group))</span><br><span class="line">for key, group in itertools.groupby(&apos;AaaBbbCcc&apos;, lambda c:c.upper()): //制定分组限定条件</span><br><span class="line">    print(key, list(group))</span><br></pre></td></tr></table></figure></li></ul><h3 id="contextlib"><a href="#contextlib" class="headerlink" title="contextlib"></a>contextlib</h3><ul><li><p>某个对象方法的前后添加代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">from contextlib import contextmanager</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Query(object):</span><br><span class="line">    def __init__(self, name):</span><br><span class="line">        self.name = name</span><br><span class="line"></span><br><span class="line">    def query(self):</span><br><span class="line">        print(&apos;query info about &#123;0&#125;&apos;.format(self.name))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@contextmanager</span><br><span class="line">def create_query(name):</span><br><span class="line">    print(&apos;begin&apos;)</span><br><span class="line">    q = Query(name)</span><br><span class="line">    yield q</span><br><span class="line">    print(&apos;end&apos;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">with create_query(&apos;tinytinycn&apos;) as q:</span><br><span class="line">    q.query()</span><br></pre></td></tr></table></figure></li><li><p>某段代码前后添加特定代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from contextlib import contextmanager</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@contextmanager</span><br><span class="line">def tag(name):</span><br><span class="line">    print(&apos;&lt;&#123;0&#125;&gt;&apos;.format(name))</span><br><span class="line">    yield</span><br><span class="line">    print(&apos;&lt;/&#123;0&#125;&gt;&apos;.format(name))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">with tag(&apos;div&apos;):</span><br><span class="line">    print(&apos;\thello&apos;)</span><br><span class="line">    print(&apos;\tworld&apos;)</span><br></pre></td></tr></table></figure></li><li><p>如果某个对象没有实现上下文, 就不能用于with语句, 需要使用closing()把对象变成上下文对象</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from contextlib improt closing</span><br><span class="line">from urllib.request import urlopen</span><br><span class="line"></span><br><span class="line">with closing(urlopen(&apos;http://www.python.org&apos;)) as page:</span><br><span class="line">    for line in page:</span><br><span class="line">        print(line)</span><br></pre></td></tr></table></figure></li><li><p>closing是一个进过@contextmanager修饰的generator</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@contextmanager</span><br><span class="line">def closing(thing):</span><br><span class="line">    try:</span><br><span class="line">        yield thing</span><br><span class="line">    finally:</span><br><span class="line">        thing.close()</span><br></pre></td></tr></table></figure></li></ul><h3 id="urllib"><a href="#urllib" class="headerlink" title="urllib"></a>urllib</h3><ul><li>urllib提供的功能就是利用程序去执行各种HTTP请求<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">from urllib import request, parse</span><br><span class="line"></span><br><span class="line">print(&apos;login to weibo.cn...&apos;)</span><br><span class="line">email = input(&apos;email: &apos;)</span><br><span class="line">password = input(&apos;password: &apos;)</span><br><span class="line">login_data = parse.urlencode([</span><br><span class="line">    (&apos;username&apos;, email),</span><br><span class="line">    (&apos;password&apos;, password),</span><br><span class="line">    (&apos;client_id&apos;, &apos;&apos;),</span><br><span class="line">    (&apos;savestate&apos;, 1),</span><br><span class="line">    (&apos;ec&apos;, &apos;&apos;),</span><br><span class="line">    (&apos;pagerefer&apos;, &apos;https://passport.weibo.cn/signin/welcome?entry=mweibo&amp;r=http%3A%2F%2Fm.weibo.cn%2F&apos;)</span><br><span class="line">])</span><br><span class="line"># post header</span><br><span class="line">req = request.Request(&apos;https://passport.weibo.cn/sso/login&apos;)</span><br><span class="line">req.add_header(&apos;Origin&apos;, &apos;https://passport.weibo.cn&apos;)</span><br><span class="line">req.add_header(&apos;User-Agent&apos;,</span><br><span class="line">               &apos;Mozilla/6.0 (iPhone; CPU iPhone OS 8_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/8.0 Mobile/10A5376e Safari/8536.25&apos;)</span><br><span class="line">req.add_header(&apos;Referer&apos;,</span><br><span class="line">               &apos;https://passport.weibo.cn/signin/login?entry=mweibo&amp;res=wel&amp;wm=3349&amp;r=http%3A%2F%2Fm.weibo.cn%2F&apos;)</span><br><span class="line"># 代理</span><br><span class="line">proxy_handler = request.ProxyHandler(&#123;&apos;http&apos;: &apos;http://www.example.com:3128/&apos;&#125;)</span><br><span class="line">proxy_basic_auth_handler = request.ProxyBasicAuthHandler()</span><br><span class="line">proxy_basic_auth_handler.add_password(&apos;realm&apos;, &apos;host&apos;, &apos;username&apos;, &apos;password&apos;)</span><br><span class="line">opener = request.build_opener(proxy_handler, proxy_basic_auth_handler)</span><br><span class="line"></span><br><span class="line"># 提交data</span><br><span class="line">with opener.open(req, data=login_data.encode(&apos;utf-8&apos;)) as f:</span><br><span class="line">    print(&apos;status: &apos;, f.status, f.reason)</span><br><span class="line">    for k, v in f.getheaders():</span><br><span class="line">        print(&apos;&#123;0&#125;: &#123;1&#125;&apos;.format(k, v))</span><br><span class="line">    print(&apos;data: &apos;, f.read().decode(&apos;utf-8&apos;))</span><br></pre></td></tr></table></figure></li></ul><h3 id="HTMLParse"><a href="#HTMLParse" class="headerlink" title="HTMLParse"></a>HTMLParse</h3><ul><li>解析html<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">from html.parser import HTMLParser</span><br><span class="line">from html.entities import name2codepoint</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class MyHTMLParser(HTMLParser):</span><br><span class="line">    def handle_starttag(self, tag, attrs):</span><br><span class="line">        print(&apos;&lt;&#123;0&#125;&gt;&apos;.format(tag))</span><br><span class="line"></span><br><span class="line">    def handle_endtag(self, tag):</span><br><span class="line">        print(&apos;&lt;/&#123;0&#125;&gt;&apos;.format(tag))</span><br><span class="line"></span><br><span class="line">    def handle_startendtag(self, tag, attrs):</span><br><span class="line">        print(&apos;&lt;&#123;0&#125;/&gt;&apos;.format(tag))</span><br><span class="line"></span><br><span class="line">    def handle_data(self, data):</span><br><span class="line">        print(data)</span><br><span class="line"></span><br><span class="line">    def handle_comment(self, data):</span><br><span class="line">        print(&apos;&lt;!--&apos;, data, &apos;--&gt;&apos;)</span><br><span class="line"></span><br><span class="line">    def handle_entityref(self, name):</span><br><span class="line">        print(&apos;&amp;&#123;0&#125;&apos;.format(name))</span><br><span class="line"></span><br><span class="line">    def handle_charref(self, name):</span><br><span class="line">        print(&apos;&amp;#&#123;0&#125;&apos;.format(name))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">html_parser = MyHTMLParser()</span><br><span class="line">html_parser.feed(</span><br><span class="line">    &apos;&apos;&apos;</span><br><span class="line">    &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;!-- test html parser --&gt;&lt;p&gt;Some &lt;a href=\&quot;#\&quot;&gt;html&lt;/a&gt; HTML&amp;nbsp;tutorial...&lt;br&gt;END&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;</span><br><span class="line">    &apos;&apos;&apos;</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;datetime日期时间&quot;&gt;&lt;a href=&quot;#datetime日期时间&quot; class=&quot;headerlink&quot; title=&quot;datetime日期时间&quot;&gt;&lt;/a&gt;datetime日期时间&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;
      
    
    </summary>
    
    
      <category term="python" scheme="http://github.com/categories/python/"/>
    
    
  </entry>
  
  <entry>
    <title>python-11-正则</title>
    <link href="http://github.com/2018/09/14/python-11-%E6%AD%A3%E5%88%99/"/>
    <id>http://github.com/2018/09/14/python-11-正则/</id>
    <published>2018-09-14T03:53:41.000Z</published>
    <updated>2019-09-22T09:25:59.291Z</updated>
    
    <content type="html"><![CDATA[<ul><li><p>\d 1个数字</p></li><li><p>\w 1个字母</p></li><li><p>\s 1个空格</p></li><li><p>.  1个字符</p></li><li><ul><li>0到多个</li></ul></li><li><ul><li>1到多个</li></ul></li><li><p>? 0或1个</p></li><li><p>{n} n个</p></li><li><p>{n,m} n到m个</p></li><li><p>[] 范围内的一个</p></li><li><p>(|) 其中的一个</p></li><li><p>^开头 结尾$</p></li><li><p>\转义</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">s=&apos;abc\\-007&apos; # python字符串 python中 \为转义字符</span><br><span class="line">&apos;abc\-007&apos;    # 正则字符串 正则中 \为转义字符</span><br><span class="line"></span><br><span class="line">s2=r&apos;abc\-007&apos; # 使用r前缀, 不用考虑python中的转义问题</span><br><span class="line">&apos;abc\-007&apos;    # 正则字符串</span><br><span class="line"></span><br><span class="line">import re</span><br><span class="line">re.match(r&apos;^\w&#123;3&#125;\-\d&#123;1,3&#125;$&apos;, &apos;abc-007&apos;)  # 匹配成功, 返回Match对象. 否则None</span><br></pre></td></tr></table></figure></li><li><p>split切分</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">re.split(r&apos;[\s+\,\;]+&apos;, &apos;a b,c; ;d , e&apos;)</span><br></pre></td></tr></table></figure></li><li><p>()分组</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">m=re.match(r&apos;^(\w&#123;3&#125;)\-(\d&#123;1,5&#125;)$&apos;, &apos;abc-1234&apos;)</span><br><span class="line">m.group(0) //abc-1234 # 永远是原始字符串</span><br><span class="line">m.group(1) //abc      # 匹配的子串</span><br><span class="line">m.group(2) //1234     # 匹配的子串</span><br><span class="line">m.groups() //(&apos;abc&apos;, &apos;1234&apos;)</span><br></pre></td></tr></table></figure></li><li><p>贪婪匹配(默认), 匹配尽可能多的字符</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">re.match(r&apos;^(\d+)(0*)$&apos;, &apos;123000&apos;).groups() // (&apos;123000&apos;, &apos;&apos;) 贪婪模式\d+匹配到最后一个0, 0*只能匹配到空串</span><br><span class="line">re.match(r&apos;^(\d+?)(0*)$&apos;, &apos;123000&apos;).groups() //(&apos;123&apos;, &apos;000&apos;) 使用? 非贪婪模式\d+?匹配尽可能少的字符, 0*匹配到尽可能多的0</span><br></pre></td></tr></table></figure></li><li><p>预编译正则表达式</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">re_tel=re.compile(r&apos;^(\d&#123;3&#125;)\-(\d&#123;3,8&#125;)$&apos;)</span><br><span class="line">re_tel.match(&apos;010-12345&apos;).groups()</span><br><span class="line">re_tal.match(&apos;010-8086&apos;).groups()</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ul&gt;
&lt;li&gt;&lt;p&gt;\d 1个数字&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;\w 1个字母&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;\s 1个空格&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;.  1个字符&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;ul&gt;
&lt;li&gt;0到多个&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;

      
    
    </summary>
    
    
      <category term="python" scheme="http://github.com/categories/python/"/>
    
    
  </entry>
  
  <entry>
    <title>python-10-进程线程</title>
    <link href="http://github.com/2018/09/14/python-10-%E8%BF%9B%E7%A8%8B%E7%BA%BF%E7%A8%8B/"/>
    <id>http://github.com/2018/09/14/python-10-进程线程/</id>
    <published>2018-09-14T02:23:41.000Z</published>
    <updated>2019-09-22T09:25:37.518Z</updated>
    
    <content type="html"><![CDATA[<p>null</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;null&lt;/p&gt;

      
    
    </summary>
    
    
      <category term="python" scheme="http://github.com/categories/python/"/>
    
    
  </entry>
  
  <entry>
    <title>python-09-io</title>
    <link href="http://github.com/2018/09/13/python-09-io/"/>
    <id>http://github.com/2018/09/13/python-09-io/</id>
    <published>2018-09-13T10:03:41.000Z</published>
    <updated>2019-09-22T09:24:53.293Z</updated>
    
    <content type="html"><![CDATA[<h3 id="文件读写"><a href="#文件读写" class="headerlink" title="文件读写"></a>文件读写</h3><ul><li>读文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">f=open(&apos;/home/tinytinycn/test.log&apos;, &apos;r&apos;) //读文件模式r</span><br><span class="line">f.read() //&apos;hello,world&apos;, 若文件不存在, 则抛出IOError</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure></li></ul><p>或者</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">with open(&apos;/home/tinytinycn/test.log&apos;, &apos;r&apos;) as f:</span><br><span class="line">    print(f.read()) //with自动调用close()方法</span><br></pre></td></tr></table></figure><ul><li><p>合理读取文件内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">f.read() //一次行读取全部内容</span><br><span class="line">f.read(size) //每次按size个字节读取</span><br><span class="line">f.readlines()一次读取全部内容并返回list 适合配置文件</span><br></pre></td></tr></table></figure></li><li><p>file-like Object, 包含有read()方法的对象, 无需集成特定类</p></li><li><p>读取二级制文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">f=open(&apos;/home/tinytinycn/test.jpg&apos;, &apos;rb&apos;)</span><br><span class="line">f.read() //十六进制表示字节</span><br></pre></td></tr></table></figure></li><li><p>读取编码文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">f=open(&apos;/home/tinytinycn/gbk.txt&apos;, &apos;r&apos;, encoding=&apos;gbk&apos;)</span><br><span class="line">f.read()</span><br></pre></td></tr></table></figure></li><li><p>写文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">f=open(&apos;/home/tinytinycn/test.log&apos;, &apos;w&apos;)</span><br><span class="line">f.write(&apos;hello world&apos;) //不会立即写入磁盘, 放入内存缓存, 空闲时写入</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure></li></ul><p>或</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">with f=open(&apos;/home/tinytinycn/test.log&apos;, &apos;w&apos;) as f:</span><br><span class="line">    f.wirte(&apos;hello world&apos;) //覆盖文件</span><br></pre></td></tr></table></figure><h3 id="StringIO-amp-BytesIO"><a href="#StringIO-amp-BytesIO" class="headerlink" title="StringIO &amp; BytesIO"></a>StringIO &amp; BytesIO</h3><ul><li><p>StringIO读写, 操作str</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from io import StringIO</span><br><span class="line"></span><br><span class="line">f=StringIO()</span><br><span class="line">f.write(&apos;hello world&apos;)</span><br><span class="line"></span><br><span class="line">f2=StringIO(&apos;hello\nhi\npython&apos;)</span><br><span class="line">while True:</span><br><span class="line">    s=f2.readline()</span><br><span class="line">    if s==&apos;&apos;:</span><br><span class="line">        break</span><br><span class="line">    print(s.strip())</span><br></pre></td></tr></table></figure></li><li><p>BytesIO读写, 操作二进制</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from io import BytesIO</span><br><span class="line"></span><br><span class="line">f=Bytes()</span><br><span class="line">f.write(&apos;中文&apos;.encode(&apos;utf-8&apos;)) //写入经过utf-8编码的bytes</span><br><span class="line">print(f.getvalue()) //b&apos;\xe4\xb8\xad...&apos;</span><br><span class="line"></span><br><span class="line">f2=Bytes(b&apos;\xe4\xb8\xad...&apos;)</span><br><span class="line">f.read()</span><br></pre></td></tr></table></figure></li></ul><h3 id="操作文件-amp-目录"><a href="#操作文件-amp-目录" class="headerlink" title="操作文件 &amp; 目录"></a>操作文件 &amp; 目录</h3><ul><li><p>操作目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">os.path.abspath(&apos;.&apos;)</span><br><span class="line">os.path.join(&apos;/home/tinytinycn&apos;, &apos;testdir&apos;) //某个目录下创建新目录</span><br><span class="line">os.mkdir(&apos;/home/tinytinycn/testdir&apos;) //创建目录</span><br><span class="line">os.rmdir(&apos;/home/tinytinycn/testdir&apos;) //删除目录</span><br><span class="line">os.path.split(&apos;/home/tinytinycn/testdir/file.log&apos;) //(&apos;/home/tinytinycn/testdir&apos;, &apos;file.log&apos;)</span><br><span class="line">os.path.splittest(&apos;/path/to/file.log&apos;) //(&apos;/path/to/file&apos;, &apos;.txt&apos;)</span><br></pre></td></tr></table></figure></li><li><p>操作文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">os.rename(&apos;test.txt&apos;, &apos;test.py&apos;) //修改当前目录文件名</span><br><span class="line">os.remove(&apos;test.py&apos;) //删除文件</span><br></pre></td></tr></table></figure></li><li><p>os模块不提供复制文件函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import shutil</span><br><span class="line"></span><br><span class="line">[x for x in os.listdir(&apos;.&apos;) if os.path.isdir(x)]</span><br><span class="line">[x for x in os.listdir(&apos;.&apos;) if os.path.isfile(x) and os.path.splitext(x)[1]==&apos;.py&apos;]</span><br></pre></td></tr></table></figure></li></ul><h3 id="序列化"><a href="#序列化" class="headerlink" title="序列化"></a>序列化</h3><ul><li><p>序列化, 将内存中的数据写入磁盘或通过网络传输到其他机器上</p></li><li><p>python提供pickle模块实现序列化</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import pickle</span><br><span class="line"></span><br><span class="line">D=dict(name=&apos;tiny&apos;, age=25, score=100)</span><br><span class="line">pickle.dumps(D) //序列化为一个bytes, 可将bytes写入文件</span><br><span class="line"></span><br><span class="line">或</span><br><span class="line">f=open(&apos;dump.txt&apos;, &apos;wb&apos;)</span><br><span class="line">pickle.dump(D, f) //直接将对象序列化后写入file-like Object</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line">`#` 反序列化, 把对象从磁盘读到内存中bytes, 然后通过pickle.loads()反序列化出对象</span><br><span class="line">或</span><br><span class="line">f=open(&apos;dump.txt&apos;, &apos;rb&apos;)</span><br><span class="line">D2=pickle.load(f)</span><br><span class="line">f.close()</span><br><span class="line">print(D) //反序列化后的dict对象</span><br></pre></td></tr></table></figure></li><li><p>JSON, 将对象徐丽华成标准格式, 方便在不同编程语言之间传递对象</p></li><li><p>python提供json模块实现python对象到JSON格式的转换</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import json</span><br><span class="line"></span><br><span class="line">D=dict(name=&apos;tiny&apos;, age=25, score=100)</span><br><span class="line">json.dumps(D) //返回一个str &#123;&quot;name&quot;:&quot;tiny&quot;, &quot;age&quot;:25, &quot;score&quot;:100&#125;</span><br><span class="line">或</span><br><span class="line">f=open(&apos;dump.json&apos;, &apos;w&apos;)</span><br><span class="line">json.dump(D, f) //写入一个file-like Object</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line">`#` 把JSON反序列化为Python对象，用loads()或者对应的load()方法，前者把JSON的字符串反序列化，后者从file-like Object中读取字符串并反序列化.</span><br></pre></td></tr></table></figure></li><li><p>JSON编码UTF-8</p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;文件读写&quot;&gt;&lt;a href=&quot;#文件读写&quot; class=&quot;headerlink&quot; title=&quot;文件读写&quot;&gt;&lt;/a&gt;文件读写&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;读文件&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=
      
    
    </summary>
    
    
      <category term="python" scheme="http://github.com/categories/python/"/>
    
    
  </entry>
  
  <entry>
    <title>python-08-错误调试测试</title>
    <link href="http://github.com/2018/09/13/python-08-%E9%94%99%E8%AF%AF%E8%B0%83%E8%AF%95%E6%B5%8B%E8%AF%95/"/>
    <id>http://github.com/2018/09/13/python-08-错误调试测试/</id>
    <published>2018-09-13T08:03:41.000Z</published>
    <updated>2019-09-22T09:24:33.682Z</updated>
    
    <content type="html"><![CDATA[<h3 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">try:</span><br><span class="line">    print(&apos;try start&apos;)</span><br><span class="line">    res=10/0</span><br><span class="line">    print(&apos;try end&apos;)</span><br><span class="line">except ValueError as e:</span><br><span class="line">    print(&apos;valueerror: &apos;,e)</span><br><span class="line">except ZeroDivisionError as e:</span><br><span class="line">    print(&apos;zerodivisionerror: &apos;,e)</span><br><span class="line">else:</span><br><span class="line">    print(&apos;no error&apos;)</span><br><span class="line">finally:</span><br><span class="line">    print(&apos;finally..&apos;)</span><br><span class="line">print(&apos;END&apos;)</span><br></pre></td></tr></table></figure><ul><li><p>所有的错误都从BaseException类派生</p></li><li><p>logging模块记录错误信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import logging</span><br><span class="line">def foo(s):</span><br><span class="line">    return 10/int(s)</span><br><span class="line">def bar(s):</span><br><span class="line">    return foo(s)*2</span><br><span class="line">def main():</span><br><span class="line">    try:</span><br><span class="line">        bar(0)</span><br><span class="line">    except Exception as e:</span><br><span class="line">        logging.exception(e)</span><br><span class="line"></span><br><span class="line">main() //异常, 打印错误栈</span><br><span class="line">print(&apos;END&apos;)</span><br></pre></td></tr></table></figure></li><li><p>抛出错误, 可以自定义异常class, 尽量使用内置错误类型(ValueError/TypeError)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">class FooError(ValueError):</span><br><span class="line">    pass</span><br><span class="line"></span><br><span class="line">def foo(s):</span><br><span class="line">    n=int(s)</span><br><span class="line">    if n==0:</span><br><span class="line">        raise FooError(&apos;invalid value: %s&apos; % s)</span><br><span class="line">    return 10/n</span><br><span class="line"></span><br><span class="line">foo(&apos;0&apos;)</span><br></pre></td></tr></table></figure></li></ul><h3 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h3><ul><li><p>print()</p></li><li><p>断言assert, 断言失败将抛出AssertionError</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">def foo(s):</span><br><span class="line">    n=int(s)</span><br><span class="line">    assert n!=0, &apos;n is zero!&apos; //断言表达式应该为True,　否则False执行后续代码</span><br><span class="line">    return 10/n</span><br><span class="line">def main():</span><br><span class="line">    foo(&apos;0&apos;) //抛出异常</span><br></pre></td></tr></table></figure></li><li><p>启动python解释器关闭assert</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -0 hello.py</span><br></pre></td></tr></table></figure></li><li><p>logging, 不会抛出错误, 且可以输出到文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import logging</span><br><span class="line">logging.basicConfig(level=logging.INFO) //指定输出级别debug/info/warning/error</span><br><span class="line"></span><br><span class="line">s=&apos;0&apos;</span><br><span class="line">n=int(s)</span><br><span class="line">logging.info(&apos;n=%d&apos; % n) //</span><br><span class="line">print(10/n)</span><br></pre></td></tr></table></figure></li><li><p>pdb调试器, 让程序单步执行, 随时查看运行状态</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m pdb hello.py //n下一步 l查看　p 变量名　q结束调试</span><br></pre></td></tr></table></figure></li><li><p>pdb.set_trace()设置断点</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import pdb</span><br><span class="line"></span><br><span class="line">s=&apos;0&apos;</span><br><span class="line">n=int(s)</span><br><span class="line">pdb.set_trace() //运行到此处自动暂停　c继续运行</span><br><span class="line">print(10/n)</span><br></pre></td></tr></table></figure></li><li><p>IDE调试</p></li></ul><h3 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h3><ul><li>测试类需要继承unittest.TestCase</li><li>以test开头的方法为测试方法, 其他方法不会被执行</li><li>assertEqual()</li><li>assertRaises()</li><li>setUp()/tearDown()方法分别在调佣每一个测试方法前后分别被执行, 解决重复代码</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">`#`mydict.py模块编写如下代码</span><br><span class="line">class Dict(dict): </span><br><span class="line">    def __init__(self, **kw):</span><br><span class="line">        super().__init__(**kw)</span><br><span class="line">    def __getattr__(self, key):</span><br><span class="line">        try:</span><br><span class="line">            return self[key]</span><br><span class="line">        except KeyError:</span><br><span class="line">            raise AttributeError(&apos;Dict object has no attribute &#123;0&#125;&apos;.format(key))</span><br><span class="line">    def __setattr__(self, key, value):</span><br><span class="line">        self[key]=value</span><br><span class="line"></span><br><span class="line">`#`测试mydict_test.py模块编写如下代码</span><br><span class="line">import unittest</span><br><span class="line">from mydict import Dict //引入需要测试的自定义模块</span><br><span class="line"></span><br><span class="line">class TestDict(unittest.TestCase):</span><br><span class="line">    def test_init(self):</span><br><span class="line">　　　　　　　　d=Dict(a=1, b=&apos;test&apos;)</span><br><span class="line">        self.assertEqual(d.a, 1)</span><br><span class="line">        self.assertEqual(d.b, &apos;test&apos;)</span><br><span class="line">        self.assertTrue(isinstance(d, dict))</span><br><span class="line">    def test_key(key):</span><br><span class="line">        d=Dict()</span><br><span class="line">        d[&apos;key&apos;]=&apos;value&apos;</span><br><span class="line">        self.assertEqual(d.key, &apos;value&apos;)</span><br><span class="line">　　　　def test_keyerror(self):</span><br><span class="line">        d=Dict()</span><br><span class="line">        with self.assertRaises(KeyError)</span><br><span class="line">            value=d[&apos;empty&apos;]</span><br><span class="line"></span><br><span class="line">python3 mydict_test.py 或　python3 -m unittest mydict_test (推荐, 可以一次批量运行多个单元测试)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;错误处理&quot;&gt;&lt;a href=&quot;#错误处理&quot; class=&quot;headerlink&quot; title=&quot;错误处理&quot;&gt;&lt;/a&gt;错误处理&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pr
      
    
    </summary>
    
    
      <category term="python" scheme="http://github.com/categories/python/"/>
    
    
  </entry>
  
  <entry>
    <title>python-07-面向对象高级编程</title>
    <link href="http://github.com/2018/09/13/python-07-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B/"/>
    <id>http://github.com/2018/09/13/python-07-面向对象高级编程/</id>
    <published>2018-09-13T07:33:41.000Z</published>
    <updated>2019-09-22T09:24:06.815Z</updated>
    
    <content type="html"><![CDATA[<h3 id="solts"><a href="#solts" class="headerlink" title="__solts"></a>__solts</h3><ul><li><p>先定义class, 后绑定属性和方法</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">class Student(object):</span><br><span class="line">    pass</span><br><span class="line"></span><br><span class="line">from types import MethodType</span><br><span class="line">def set_age(self, age): # 定义一个函数作为实例方法</span><br><span class="line">    self.age=age</span><br><span class="line"></span><br><span class="line">s = Student()</span><br><span class="line">s.name = &apos;tiny&apos;</span><br><span class="line">s.age = 25 //25</span><br><span class="line">s.set_age = MethodType(set_age, s) //绑定方法到实例s, 该方法只作用该实例</span><br><span class="line">s.set_age(26)</span><br><span class="line">s.age //26</span><br><span class="line"></span><br><span class="line">def set_score(self, score):</span><br><span class="line">    self.score=score</span><br><span class="line"></span><br><span class="line">Student.set_score=set_score //一般类方法直接定义在class中, 动态绑定允许在运行过程中动态给class加上方法, 使得该方法作用所有实例</span><br><span class="line">s1.set_score(100)</span><br><span class="line">s1.score //100</span><br><span class="line">s2.set_score(99)</span><br><span class="line">s2.score //99</span><br></pre></td></tr></table></figure></li><li><p>定义class时使用<code>__slots__</code>变量, 限制class实例属性的添加. 但不限制该class的子类实例属性的添加!!!</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class Student(object):</span><br><span class="line">    __slots__ =(&apos;name&apos;, &apos;age&apos;)</span><br><span class="line"></span><br><span class="line">s = Student()</span><br><span class="line">s.name = &apos;tiny&apos;</span><br><span class="line">s.age = 25</span><br><span class="line">s.score = 100 //AttributeError 报错</span><br></pre></td></tr></table></figure></li></ul><h3 id="property"><a href="#property" class="headerlink" title="@property"></a>@property</h3><p>@property装饰器负责把一个方法变成属性调用</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">class Student(object):</span><br><span class="line">    @property</span><br><span class="line">    def score(self):</span><br><span class="line">        return self.score</span><br><span class="line">    @score.setter</span><br><span class="line">    def score(self, val):</span><br><span class="line">        if not isinstance(val, int):</span><br><span class="line">            raise ValueError(&apos;score must be an integer!!&apos;)</span><br><span class="line">        if value&lt;0 or value&gt;100:</span><br><span class="line">            raise ValueError(&apos;score must between 0-100&apos;)</span><br><span class="line">        self.score=val</span><br><span class="line"></span><br><span class="line">s = Student()</span><br><span class="line">s.score = 99 //实际转化为 s.set_score(99)</span><br><span class="line">s.score 　　　　　//实际转化为 s.get_score()</span><br></pre></td></tr></table></figure><h3 id="多重继承"><a href="#多重继承" class="headerlink" title="多重继承"></a>多重继承</h3><ul><li>MixIn的目的是给一个类增加多个功能, 通过多重继承组合多个MixIn功能, 而不是设计多层次复杂的继承关系.<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">class Dog(Mammal, RunnableMixIn, CarnivaorousMixIn):</span><br><span class="line">    pass</span><br></pre></td></tr></table></figure></li></ul><h3 id="定制类"><a href="#定制类" class="headerlink" title="定制类"></a>定制类</h3><ul><li><p><code>__str__()</code>定制print(Student())的信息</p></li><li><p><code>__repr__()</code>定制s的信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">class Student(object):</span><br><span class="line">    def __init__(self, name):</span><br><span class="line">        self.name=name</span><br><span class="line">    def __str__(self):</span><br><span class="line">        print(&apos;student object (name:&#123;1&#125;))&apos;.format(self.name))</span><br><span class="line">    __repr__=__str__</span><br><span class="line"></span><br><span class="line">s = Student(&apos;tiny&apos;) //实际调用__str__()</span><br><span class="line">s //实际调用__repr__()</span><br></pre></td></tr></table></figure></li><li><p>一个类实现<code>__iter__()</code>方法返回一个迭代对象, 调用迭代对象<code>__next__()</code>方法拿到循环的下一个值, 知道StopIteration错误推出循环</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">class　Fib(object):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.a,self.b=0,1</span><br><span class="line">    def __iter__(self):</span><br><span class="line">        return self</span><br><span class="line">    def __next__(self):</span><br><span class="line">        self.a,self.b=self.b,self.a+self.b</span><br><span class="line">        if self.a&gt;1000:</span><br><span class="line">            raise StopIteration()</span><br><span class="line">        return self.a</span><br><span class="line"></span><br><span class="line">for n in Fib():</span><br><span class="line">    print(n)</span><br></pre></td></tr></table></figure></li><li><p><code>__getitem__()</code>方法使得对象可以像list一样按下标或切片slice去元素</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">class Fib(object):</span><br><span class="line">    def __getitem__(self, n):</span><br><span class="line">      if isinstance(n, int):</span><br><span class="line">        a,b=1,1</span><br><span class="line">        for x in range(n):</span><br><span class="line">            a,b=b,a+b</span><br><span class="line">        return a</span><br><span class="line">      if isinstance(n, slice):</span><br><span class="line">        start = n.start</span><br><span class="line">        stop = n.stop</span><br><span class="line">        if start is None:</span><br><span class="line">           start=0</span><br><span class="line">        a,b=1,1</span><br><span class="line">        L=[]</span><br><span class="line">        for x in range(stop):</span><br><span class="line">            if x&gt;=start:</span><br><span class="line">                L.append(a)</span><br><span class="line">            a,b=b,a+b</span><br><span class="line">        return L</span><br><span class="line"></span><br><span class="line">f=Fib()</span><br><span class="line">f[0:5] //[1,1,2,3,5], 注意程序没有对f[2:5]做处理!!!</span><br></pre></td></tr></table></figure></li><li><p><code>__getitem__()</code> <code>__setitem__()</code> <code>__delitem__()</code>方法使得自定义类表现得和list,tuple,dict很像, 归功于动态语言的’鸭子类型’, 不需要强制继承某个接口</p></li><li><p><code>__getattr__()</code>动态返回一个属性, 当调用一个实例的属性时, 在没有该属性时, 才调用<code>__getattr__()</code>方法, 默认返回None</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">class Student(object):</span><br><span class="line">    def __getattr__(self, attr):</span><br><span class="line">        if attr==&apos;age&apos;:</span><br><span class="line">           return lambda:25</span><br><span class="line">        raise AttributeError(&apos;student object has no attribute &#123;1&#125;&apos;.format(attr))</span><br><span class="line"></span><br><span class="line">s.age //25</span><br><span class="line">s.score //AttributeError错误</span><br><span class="line"></span><br><span class="line">class Chain(object):</span><br><span class="line">    def __init__(self, path=&apos;&apos;):</span><br><span class="line">        self._path=path</span><br><span class="line">    def __getattr__(self, path):</span><br><span class="line">        return Chain(&apos;&#123;1&#125;/&#123;2&#125;&apos;.format(self._path, path))</span><br><span class="line">    def __str__(self):</span><br><span class="line">        return self._path</span><br><span class="line">    __repr__=__str__</span><br><span class="line"></span><br><span class="line">Chain().status.user.timeline.list //链式调用:&apos;/status/user/timeline/list&apos;</span><br></pre></td></tr></table></figure></li><li><p><code>__call__()</code>方法使得对象可以看成函数, 接调用实例本身的方法. </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">class Student(object):</span><br><span class="line">    def __init__(self, name):</span><br><span class="line">        self.name=name</span><br><span class="line">    def __call__(self):</span><br><span class="line">        pritn(&apos;hello, &#123;1&#125;&apos;.format(self.name))</span><br><span class="line"></span><br><span class="line">s = Student(&apos;tiny&apos;)</span><br><span class="line">s() //&apos;hello, tiny&apos; 对实例直接进行调用就像一个函数的调用一样, 判断一个变量是对象还是函数, 看能被调用对象是否为Callable对象, 比如自定义类带有__call__()方法</span><br><span class="line">callable(Student()) //True</span><br><span class="line">callable(max)       //True</span><br><span class="line">callable([1,2,3])   //False</span><br></pre></td></tr></table></figure></li></ul><h3 id="枚举类"><a href="#枚举类" class="headerlink" title="枚举类"></a>枚举类</h3><ul><li><p>value属性自动赋值int常量, 默认从1开始计数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">from enum import Enum</span><br><span class="line">Month=Enum(&apos;Month&apos;,(&apos;Jan&apos;,&apos;Feb&apos;,&apos;Mar&apos;))</span><br><span class="line"></span><br><span class="line">for name,member in Month.__members__.items():</span><br><span class="line">    print(&apos;&#123;0&#125;=&gt;&#123;1&#125;,&#123;2&#125;&apos;.format(name, member, member.value))</span><br></pre></td></tr></table></figure></li><li><p><code>@unique</code>装饰器保证没有重复值</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">from enum import Enum,unique</span><br><span class="line"></span><br><span class="line">@unique</span><br><span class="line">class Weekday(Enum):</span><br><span class="line">    Sun=0</span><br><span class="line">    Mon=1</span><br><span class="line">    Tue=2</span><br><span class="line">    Wed=3</span><br><span class="line">    Thu=4</span><br><span class="line">    Fri=5</span><br><span class="line">    Sat=6</span><br><span class="line"></span><br><span class="line">d = Weekday.Mon    //Weekday.Mon</span><br><span class="line">d2= Weekday[&apos;Tue&apos;] //Weekday.Tue</span><br><span class="line">d3= Weekday.Tue.value //2</span><br><span class="line">d4= Weekday(3)     //Weekday.Wed</span><br></pre></td></tr></table></figure></li></ul><h3 id="元类"><a href="#元类" class="headerlink" title="元类"></a>元类</h3><ul><li>type()函数可以查看类型或变量的类型</li><li>type()函数可以运行期动态创建class<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">def fn(self, name=&apos;tiny&apos;):</span><br><span class="line">    print(&apos;i am &#123;0&#125;&apos;.format(name))</span><br><span class="line"></span><br><span class="line">Hello = type(&apos;Hello&apos;, (object,), dict(say=fn)) //创建Hello类, 绑定say方法(fn)</span><br><span class="line">h=Hello()</span><br><span class="line">h.say() //hello, tiny</span><br><span class="line">print(type(Hello)) //&lt;class &apos;type&apos;&gt;</span><br><span class="line">print(type(h))     //&lt;class &apos;__main__.Hello&apos;&gt;</span><br></pre></td></tr></table></figure></li></ul><h3 id="metaclass"><a href="#metaclass" class="headerlink" title="metaclass"></a>metaclass</h3><ul><li><p>元类, 动态创建类, 控制类的创建行为</p></li><li><p>先定义metaclass, 接下来创建类, 最后创建实例</p></li><li><p><code>__new__()</code>方法依次接收参数: 当前准备创建类的对象/类名/父类集合/类方法集合</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">`#` metaclass是类的模板, 必须从`type`类型派生</span><br><span class="line">class ListMetaclass(type):</span><br><span class="line">    def __new__(cls, name, bases, attrs):</span><br><span class="line">        attrs[&apos;add&apos;]=lambda self,value: self.append(value) //添加新方法</span><br><span class="line">        return type.__new__(cls, name, bases, attrs)</span><br><span class="line">`#` 指定定制类</span><br><span class="line">class MyList(list, metaclass=ListMetaclass):</span><br><span class="line">    pass</span><br><span class="line"></span><br><span class="line">`#` 创建MyList时, 要通过ListMetaclass.__new__()创建, 因此可以修改类的定义, 添加新方法</span><br><span class="line">L = MyList()</span><br><span class="line">L.add(1) //普通List没有add方法</span><br><span class="line">L //[1]</span><br></pre></td></tr></table></figure></li><li><p>一个简单的ORM框架实现</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/local/bin/python3</span><br><span class="line">class Field(object):</span><br><span class="line">    def __init__(self,name,col_type):</span><br><span class="line">        self.name=name</span><br><span class="line">        self.col_type=col_type</span><br><span class="line">    def __str__(self):</span><br><span class="line">        return &apos;&#123;0&#125;:&#123;1&#125;&apos;.format(self.__class__.__name__,self.name)</span><br><span class="line"></span><br><span class="line">class StringField(Field):</span><br><span class="line">    def __init__(self,name):</span><br><span class="line">        super(StringField, self).__init__(name,&apos;varchar(100)&apos;)</span><br><span class="line"></span><br><span class="line">class IntegerField(Field):</span><br><span class="line">    def __init__(self,name):</span><br><span class="line">        super(IntegerField, self).__init__(name, &apos;bigint&apos;)</span><br><span class="line"></span><br><span class="line">class ModelMetaclass(type):</span><br><span class="line">    def __new__(cls, name, bases, attrs):</span><br><span class="line">        if name==&apos;Model&apos;:</span><br><span class="line">            return type.__new__(cls, name, bases, attrs)</span><br><span class="line">        print(&apos;found model: &#123;0&#125;&apos;.format(name))</span><br><span class="line">        mappings=dict()</span><br><span class="line">        for k,v in attrs.items():</span><br><span class="line">            if isinstance(v, Field):</span><br><span class="line">                print(&apos;found mapping: &#123;0&#125;:&#123;1&#125;&apos;.format(k,v))</span><br><span class="line">                mappings[k]=v</span><br><span class="line">        for k in mappings.keys():</span><br><span class="line">            attrs.pop(k)</span><br><span class="line">        attrs[&apos;__mappings__&apos;]=mappings</span><br><span class="line">        attrs[&apos;__table__&apos;]=name</span><br><span class="line">        return type.__new__(cls, name, bases, attrs)</span><br><span class="line"></span><br><span class="line">class Model(dict, metaclass=ModelMetaclass):</span><br><span class="line">    def __init__(self, **kw):</span><br><span class="line">        super(Model, self).__init__(**kw)</span><br><span class="line">    def __getattr__(self, key):</span><br><span class="line">        try:</span><br><span class="line">            return self[key]</span><br><span class="line">        except KeyError:</span><br><span class="line">            raise AttributeError(&apos;model object has no attribute &#123;0&#125;&apos;.format(key))</span><br><span class="line">    def __setattr__(self, key, value):</span><br><span class="line">        self[key]=value</span><br><span class="line">    def save(self):</span><br><span class="line">        fields=[]</span><br><span class="line">        params=[]</span><br><span class="line">        args=[]</span><br><span class="line">        for k,v in self.__mappings__.items():</span><br><span class="line">            fields.append(v.name)</span><br><span class="line">            params.append(&apos;?&apos;)</span><br><span class="line">            args.append(getattr(self, k, None))</span><br><span class="line">        sql=&apos;insert into %s (%s) values (%s)&apos; % (self.__table__,&apos;,&apos;.join(fields), &apos;,&apos;.join(params))</span><br><span class="line">        print(&apos;SQL: &#123;0&#125;&apos;.format(sql))</span><br><span class="line">        print(&apos;ARGS: &#123;0&#125;&apos;.format(str(args)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class User(Model):</span><br><span class="line">    id=IntegerField(&apos;id&apos;)</span><br><span class="line">    name=StringField(&apos;username&apos;)</span><br><span class="line">    email=StringField(&apos;email&apos;)</span><br><span class="line">    password=StringField(&apos;password&apos;)</span><br><span class="line"></span><br><span class="line">u = User(id=123, name=&apos;tiny&apos;, email=&apos;t.tt@t.tt&apos;, password=&apos;pass&apos;)</span><br><span class="line">u.save()</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;solts&quot;&gt;&lt;a href=&quot;#solts&quot; class=&quot;headerlink&quot; title=&quot;__solts&quot;&gt;&lt;/a&gt;__solts&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;先定义class, 后绑定属性和方法&lt;/p&gt;
&lt;figure class=&quot;highlig
      
    
    </summary>
    
    
      <category term="python" scheme="http://github.com/categories/python/"/>
    
    
  </entry>
  
  <entry>
    <title>python-06-面向对象编程</title>
    <link href="http://github.com/2018/09/12/python-06-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B/"/>
    <id>http://github.com/2018/09/12/python-06-面向对象编程/</id>
    <published>2018-09-12T12:13:41.000Z</published>
    <updated>2019-09-22T09:23:39.559Z</updated>
    
    <content type="html"><![CDATA[<h3 id="类＆实例"><a href="#类＆实例" class="headerlink" title="类＆实例"></a>类＆实例</h3><ul><li><p>定义一个类, 创建实例的模板</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">class Student(object):</span><br><span class="line">    pass</span><br></pre></td></tr></table></figure></li><li><p>创建实例, 各个实例拥有的数据独立, 互不影响</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tiny = Student()</span><br></pre></td></tr></table></figure></li><li><p>自由绑定任何数据, ‘应该’在初始化时强制绑定必须的属性</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tiny.name=&apos;tinytinycn&apos;</span><br><span class="line"></span><br><span class="line">class Student(object):</span><br><span class="line">    def __init__(self, name, score):</span><br><span class="line">        self.name=name</span><br><span class="line">        self.score=score</span><br></pre></td></tr></table></figure></li><li><p><code>__init__</code>方法第一个参数永远是self, 代表实例本身, 上述例子传入参数，则实例化时必须传入参数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tiny = Student(&apos;tinytinycn&apos;,99)</span><br></pre></td></tr></table></figure></li><li><p>数据封装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">class Student(object):</span><br><span class="line">    def __init__(self,name,score):</span><br><span class="line">        self.name=name</span><br><span class="line">        self.score=score</span><br><span class="line">    def print_score(self):</span><br><span class="line">        print(self.name,self.score)</span><br></pre></td></tr></table></figure></li><li><p>方法, 与实例绑定的函数, 可以直接访问实例的数据. 与普通函数不同的是必须接收一个self参数．</p></li></ul><h3 id="访问限制"><a href="#访问限制" class="headerlink" title="访问限制"></a>访问限制</h3><ul><li><p><code>__</code>开头变量名, 私有变量, 只有内部可以访问, 外部不能访问</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">class Studen(object):</span><br><span class="line">    def __init__(self, name, score):</span><br><span class="line">        self.__name=name</span><br><span class="line">        self.__score=score</span><br><span class="line">    def print_score(self):</span><br><span class="line">        print(self.__name,self.__score)</span><br><span class="line"></span><br><span class="line">tiny = Student(&apos;tinytinycn&apos;, 99)</span><br><span class="line">tiny.__name //不能访问</span><br></pre></td></tr></table></figure></li><li><p><code>__xxx__</code>特殊变量, 可以外部直接访问, 不是private变量</p></li></ul><h3 id="继承＆多态"><a href="#继承＆多态" class="headerlink" title="继承＆多态"></a>继承＆多态</h3><ul><li>继承, 把父类的所有功能都直接拿过来，子类只需要新增自己特有的方法，也可以把父类不适合的方法覆盖重写</li><li>动态语言的鸭子类型特点决定了继承不像静态语言那样是必须的。</li><li>多态, 动态语言不需要严格的继承体系, 一个对象看起来像鸭子, 走路起来想鸭子就会被当作鸭子.<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">class Animal(object):</span><br><span class="line">    def run(self):</span><br><span class="line">        print(&apos;animal is running..&apos;)</span><br><span class="line"></span><br><span class="line">class Dog(Animal):</span><br><span class="line">    def run(self):</span><br><span class="line">        print(&apos;dog is running..&apos;)</span><br><span class="line"></span><br><span class="line">class Duck(Animal):</span><br><span class="line">    def run(self):</span><br><span class="line">        print(&apos;duck is running..&apos;)</span><br><span class="line"></span><br><span class="line">def run_twice(animal):</span><br><span class="line">    animal.run()</span><br><span class="line">    animal.run()</span><br><span class="line"></span><br><span class="line">run_twice(Animal())</span><br><span class="line">run_twice(Dog()) //保证传入的实例有run()方法即可</span><br><span class="line">run_twice(Duck())</span><br></pre></td></tr></table></figure></li></ul><h3 id="获取对象信息"><a href="#获取对象信息" class="headerlink" title="获取对象信息"></a>获取对象信息</h3><ul><li><p>type(x)函数, 判断对象类型</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">type(123)==type(456)</span><br><span class="line">type(123)==int</span><br><span class="line">type(&apos;abc&apos;)==type(&apos;edf&apos;)</span><br><span class="line">type(&apos;abc&apos;)==str</span><br><span class="line"></span><br><span class="line">import types</span><br><span class="line">def fn():</span><br><span class="line">    pass</span><br><span class="line"></span><br><span class="line">type(fn)==types.FunctionType</span><br><span class="line">type(abs)==types.BuiltinFunctionType</span><br><span class="line">type(lambda x:x)==types.LambdaType</span><br><span class="line">type((x for x in range(5)))==types.GeneratorType</span><br></pre></td></tr></table></figure></li><li><p>isinstance(x,y)函数, 判断class类型</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//继承关系: object -&gt; Animal　-&gt; Dog -&gt; Husky</span><br><span class="line">a = Animal()</span><br><span class="line">d = Dog()</span><br><span class="line">h = Husky()</span><br><span class="line">isinstance(h, Husky)  //True</span><br><span class="line">isinstance(h, Dog)    //True</span><br><span class="line">isinstance(h, Animal) //True</span><br><span class="line">isinstance(h, object) //True</span><br><span class="line"></span><br><span class="line">isinstance(123, int)</span><br><span class="line">isinstance(&apos;abc&apos;, str)</span><br><span class="line">isinstance(b&apos;abc&apos;, bytes)</span><br></pre></td></tr></table></figure></li><li><p>判断变量是某些类型中的一种</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">isinstance([1,2,3], (list, tuple))//True</span><br><span class="line">isinstance((1,2,3), (list, tuple))//True</span><br></pre></td></tr></table></figure></li><li><p>dir()函数, 获取对象的所有属性和方法</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dir(123)</span><br></pre></td></tr></table></figure></li><li><p>getattr()/setattr()/hasattr()操作对象的状态</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">class MyObject(object):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.x=666</span><br><span class="line">    def power(self):</span><br><span class="line">        return self.x*self.x</span><br><span class="line"></span><br><span class="line">obj = MyObject()</span><br><span class="line">hasattr(obj, &apos;x&apos;)//是否有属性x</span><br><span class="line">setattr(obj, &apos;x&apos;, 777)//设置属性x=777</span><br><span class="line">getattr(obj, &apos;x&apos;)//获取属性x</span><br><span class="line">getattr(obj, &apos;z&apos;, 999)//获取属性z, 若不存在则返回默认999</span><br><span class="line">fn = getattr(obj, &apos;power&apos;)//获取方法power, 赋值给变量fn, fn()即可调用obj.power()方法</span><br></pre></td></tr></table></figure></li></ul><h3 id="实例属性-amp-类属性"><a href="#实例属性-amp-类属性" class="headerlink" title="实例属性 &amp; 类属性"></a>实例属性 &amp; 类属性</h3><ul><li><p>类创建的实例可以绑定任意属性, 实例属性通过实例变量或self变量绑定</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class Student(object):</span><br><span class="line">    def __init__(self, name):</span><br><span class="line">        self.name=name</span><br><span class="line"></span><br><span class="line">s = Student(&apos;tiny&apos;)</span><br><span class="line">s.name = &apos;tinytinycn&apos;</span><br><span class="line">s.score = 99 //任意绑定</span><br></pre></td></tr></table></figure></li><li><p>类属性直接在class中定义属性</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">class Student(object):</span><br><span class="line">    name = &apos;student&apos;</span><br><span class="line"></span><br><span class="line">s = Student()</span><br><span class="line">print(s.name) //实例没有name属性, 搜索class的name属性</span><br><span class="line">print(Student.name) //直接访问class的name属性</span><br><span class="line">s.name = &apos;tiny&apos; //绑定实例name属性, class属性&apos;被屏蔽&apos;</span><br><span class="line">print(s.name) //实例name属性</span><br><span class="line">print(Student.name) //直接class的name属性</span><br><span class="line">del s.name //删除实例name属性</span><br><span class="line">print(s.name) //实例没有name属性, 搜索class的name属性</span><br></pre></td></tr></table></figure></li><li><p>实例属性属于各个实例, 互不干扰</p></li><li><p>类属性属于类所有, 所有实例共享一个属性</p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;类＆实例&quot;&gt;&lt;a href=&quot;#类＆实例&quot; class=&quot;headerlink&quot; title=&quot;类＆实例&quot;&gt;&lt;/a&gt;类＆实例&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;定义一个类, 创建实例的模板&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;t
      
    
    </summary>
    
    
      <category term="python" scheme="http://github.com/categories/python/"/>
    
    
  </entry>
  
  <entry>
    <title>python-05-模块</title>
    <link href="http://github.com/2018/09/12/python-05-%E6%A8%A1%E5%9D%97/"/>
    <id>http://github.com/2018/09/12/python-05-模块/</id>
    <published>2018-09-12T09:25:41.000Z</published>
    <updated>2019-09-22T09:23:12.783Z</updated>
    
    <content type="html"><![CDATA[<h3 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h3><ul><li><p>引入包后, 只要顶层包不冲突, 则所有模块不冲突</p></li><li><p>每一个包目录下都会有一个<code>__init__.py</code>的文件, 必须存在. 否则当成普通目录．</p></li><li><p>使用模块 hello.py</p></li><li><p>命令行python3 hello.py运行hello.py模块时, python解释器吧一个特殊变量<strong>name</strong>赋值<strong>main</strong>,因此会执行test()方法.而命令行导入import hello导入hello.py模块时, 则不会执行test()方法.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/local/bin/python3</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line">def test():</span><br><span class="line">    args=sys.argv</span><br><span class="line">    if len(args)==1:</span><br><span class="line">        print(&apos;hello&apos;)</span><br><span class="line">    elif　len(args)==2:</span><br><span class="line">        print(&apos;hello, &#123;1&#125;&apos;.format(args[1]))</span><br><span class="line">    else:</span><br><span class="line">        print(&apos;hello, too many arg!&apos;)</span><br><span class="line"></span><br><span class="line">if __name__==&apos;__main__&apos;:</span><br><span class="line">    test()</span><br></pre></td></tr></table></figure></li><li><p>作用域<br>一个模块中, 定义许多变量, <code>__xxx__</code>特殊变量可以被直接引用，但是有特殊用途, <code>_xxx</code>或<code>__xxx</code>private变量, ‘不应该’直接被引用</p></li><li><p>安装第三方模块</p></li></ul><p>1.pip install xxx<br>2.anaconda安装常用模块, 并将python路径指向自带python, anaconda安装的第三方模块会安装在anaconda目录下管理, 不影响已安装python目录<br>3.模块搜索路径, 加载一个模块时python会在指定路径下搜索对应.py文件, 搜索路径存放在sys.path<br>4.添加自己的搜索目录:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">sys.path.append(&apos;/home/tinytinycn/xxx_modules&apos;) //程序运行结束则失效</span><br></pre></td></tr></table></figure><p>设置环境变量PYTHONPATH, 该环境变量内容将被自动添加到模块搜索路径中!!!</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;模块&quot;&gt;&lt;a href=&quot;#模块&quot; class=&quot;headerlink&quot; title=&quot;模块&quot;&gt;&lt;/a&gt;模块&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;引入包后, 只要顶层包不冲突, 则所有模块不冲突&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;每一个包目录下都会有一个&lt;code&gt;_
      
    
    </summary>
    
    
      <category term="python" scheme="http://github.com/categories/python/"/>
    
    
  </entry>
  
  <entry>
    <title>python-04-函数式编程</title>
    <link href="http://github.com/2018/09/12/python-04-%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/"/>
    <id>http://github.com/2018/09/12/python-04-函数式编程/</id>
    <published>2018-09-12T08:53:41.000Z</published>
    <updated>2019-09-22T09:22:49.297Z</updated>
    
    <content type="html"><![CDATA[<h3 id="高阶函数"><a href="#高阶函数" class="headerlink" title="高阶函数"></a>高阶函数</h3><ul><li><p>变量可以指向函数, f=abs</p></li><li><p>函数名也是变量</p></li><li><p>传入函数, 一个函数可以接收另一个函数作为参数, 这种函数称为高阶函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">def test(x,y,f):</span><br><span class="line">    return f(x)+f(y)</span><br></pre></td></tr></table></figure></li><li><p>map/reduce</p></li></ul><p>1.map(f,Iterable)函数, 作为高阶函数, 将运算规则高度抽象了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">def f(x):</span><br><span class="line">    return x*x</span><br><span class="line"></span><br><span class="line">r=map(f,[1,2,3]) </span><br><span class="line">list(r) //[1,4,9]</span><br></pre></td></tr></table></figure><p>2.reduce(f,Iterable)函数, </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">from functools import reduce</span><br><span class="line">def fn(x,y):</span><br><span class="line">    return x*10+y</span><br><span class="line"></span><br><span class="line">reduce(fn,[1,3,5,7]) //1357</span><br></pre></td></tr></table></figure><ul><li><p>filter()函数,　用于过滤序列</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">def f(x):</span><br><span class="line">    return n%2==1</span><br><span class="line"></span><br><span class="line">list(filter(f, [1,2,3,4,5])) //[1,3,5]</span><br></pre></td></tr></table></figure></li><li><p>sorted()函数, 用于排序</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sorted([1,5,-4,-3]) //[-4,-3,1,5]</span><br><span class="line">sorted([1,5,-4,-3],key=abs) //[1,-3,-4,5]</span><br><span class="line">sorted([&apos;a&apos;,&apos;D&apos;,&apos;b&apos;,&apos;C&apos;]) //由于&apos;Z&apos;&lt;&apos;a&apos;, [&apos;C&apos;,&apos;D&apos;,&apos;a&apos;,&apos;b&apos;]</span><br><span class="line">sorted([&apos;a&apos;,&apos;D&apos;,&apos;b&apos;,&apos;C&apos;], key=str.lower) //[&apos;a&apos;,&apos;b&apos;,&apos;C&apos;,&apos;D&apos;] </span><br><span class="line">sorted([&apos;a&apos;,&apos;D&apos;,&apos;b&apos;,&apos;C&apos;], key=str.lower, reverse=True) //[&apos;D&apos;,&apos;C&apos;,&apos;b&apos;,&apos;a&apos;]</span><br></pre></td></tr></table></figure></li></ul><h3 id="返回函数"><a href="#返回函数" class="headerlink" title="返回函数"></a>返回函数</h3><ul><li>函数作为返回值</li></ul><p>1.内部函数sum可以引用外部函数lazy_sum的参数和局部变量<br>2.返回内部函数sum时, 相关参数和变量都保存在返回的sum函数中(称为’闭包’closure)<br>3.每次调用lazy_sum函数时, 返回新的函数<br>4.返回一个函数时，牢记该函数并未执行，返回函数中不要引用任何可能会变化的变量</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">def lazy_sum(*args):</span><br><span class="line">    def sum():</span><br><span class="line">        ax=0</span><br><span class="line">        for n in args:</span><br><span class="line">            ax=ax+n</span><br><span class="line">        return ax</span><br><span class="line">    return sum</span><br><span class="line"></span><br><span class="line">f=lazy_sum(1,3,4,5) //f 返回一个函数, 而不是函数计算结果</span><br><span class="line">f() //13 返回函数计算结果</span><br><span class="line"></span><br><span class="line">f2=lazy_sum(1,3,4,5)</span><br><span class="line">f1==f2 //False 新的函数, 但不影响函数计算结果</span><br></pre></td></tr></table></figure><h3 id="匿名函数"><a href="#匿名函数" class="headerlink" title="匿名函数"></a>匿名函数</h3><ul><li>无需显式定义函数, 但只能有一个表达式</li><li>匿名函数可指定给变量</li><li>匿名函数可作为返回值<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">lambda x:x*x+1</span><br><span class="line"></span><br><span class="line">def f(x):</span><br><span class="line">    return x*x+1</span><br><span class="line"></span><br><span class="line">fn=lambda x:x*x+1</span><br><span class="line">fn(2)</span><br><span class="line"></span><br><span class="line">def test(x,y):</span><br><span class="line">    return lambda: x*x+y*y</span><br></pre></td></tr></table></figure></li></ul><h3 id="包装器"><a href="#包装器" class="headerlink" title="包装器"></a>包装器</h3><ul><li>函数是一个对象, 函数对象有一个<code>__name__</code>属性</li><li>装饰器, 在代码运行期间动态增加功能的方式<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/local/bin/python3</span><br><span class="line">import functools</span><br><span class="line">def logger(*test):</span><br><span class="line">    def decotator(func):</span><br><span class="line">        @functools.wraps(func)</span><br><span class="line">        def wrapper(*args,**kw):</span><br><span class="line">            print(&apos;begin call&apos;)</span><br><span class="line">            out=func(*args,**kw)</span><br><span class="line">            print(&apos;after call&apos;)</span><br><span class="line">            return out</span><br><span class="line">        return wrapper</span><br><span class="line">    return decotator</span><br><span class="line"></span><br><span class="line">@logger(&apos;execute&apos;)</span><br><span class="line">def now_test(time):</span><br><span class="line">    print(time)</span><br><span class="line"></span><br><span class="line">@logger()</span><br><span class="line">def now_test2():</span><br><span class="line">    print(&apos;haha&apos;)</span><br><span class="line"></span><br><span class="line">now_test(&apos;2018-09-12&apos;) //logger(&apos;execute&apos;)(now_test)</span><br><span class="line">now_test2() //logger(now_test2)</span><br></pre></td></tr></table></figure></li></ul><h3 id="偏函数"><a href="#偏函数" class="headerlink" title="偏函数"></a>偏函数</h3><ul><li>偏函数, 降低函数调用的难度</li><li>作用是把一个函数的某些参数固定, 返回一个新函数, 使得调用更简单<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import functools</span><br><span class="line"></span><br><span class="line">def int2(x, base=2):</span><br><span class="line">    return int(x, base)</span><br><span class="line">int2(&apos;1010101&apos;) //85</span><br><span class="line"></span><br><span class="line">int2=functools.partial(int, base=2)</span><br><span class="line">int2(&apos;1000000) //64, 实际上kw=&#123;&apos;base&apos;:2&#125;;int(&apos;1000000&apos;, **kw)</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;高阶函数&quot;&gt;&lt;a href=&quot;#高阶函数&quot; class=&quot;headerlink&quot; title=&quot;高阶函数&quot;&gt;&lt;/a&gt;高阶函数&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;变量可以指向函数, f=abs&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;函数名也是变量&lt;/p&gt;
&lt;/li&gt;
&lt;l
      
    
    </summary>
    
    
      <category term="python" scheme="http://github.com/categories/python/"/>
    
    
  </entry>
  
  <entry>
    <title>python-03-高级特性</title>
    <link href="http://github.com/2018/09/12/python-03-%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7/"/>
    <id>http://github.com/2018/09/12/python-03-高级特性/</id>
    <published>2018-09-12T08:40:41.000Z</published>
    <updated>2019-09-22T09:22:25.773Z</updated>
    
    <content type="html"><![CDATA[<h3 id="切片"><a href="#切片" class="headerlink" title="切片"></a>切片</h3><ul><li>截取list或tuple的部分元素</li><li>截取字符串元素<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">L=[1,2,3,4,5]</span><br><span class="line">L[0:3] //[1,2,3], 前闭后开</span><br><span class="line">L[:3]  //[1,2,3]</span><br><span class="line">L[1:3] //[2,3]</span><br><span class="line">L[-1]  //[5]</span><br><span class="line">L[:5:2]//[1,3]</span><br><span class="line">L[:]   //[1,2,3,4,5]</span><br><span class="line"></span><br><span class="line">(0,1,2,3,4,5)[:3] //(0,1,2)</span><br><span class="line"></span><br><span class="line">&apos;abcdef&apos;[:3]　//&apos;abc&apos;</span><br></pre></td></tr></table></figure></li></ul><h3 id="迭代"><a href="#迭代" class="headerlink" title="迭代"></a>迭代</h3><ul><li>循环遍历list或tuple</li><li>for 循环时, 作用对象为可迭代对象Iterable </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">L=[1,3,5,7]</span><br><span class="line">L2=[(1,1),(2,2),(3,3)]</span><br><span class="line">D=&#123;&apos;a&apos;:&apos;1&apos;,&apos;b&apos;:2,&apos;c&apos;:3&#125;</span><br><span class="line"></span><br><span class="line">for x in L:</span><br><span class="line">    print(x)</span><br><span class="line"></span><br><span class="line">for i,val in enumerate(L):</span><br><span class="line">    print(i,val)</span><br><span class="line"></span><br><span class="line">for x,y in L2:</span><br><span class="line">    print(x,y)</span><br><span class="line"></span><br><span class="line">for key in D:</span><br><span class="line">    print(key)</span><br><span class="line"></span><br><span class="line">for val in D.values():</span><br><span class="line">    print(val)</span><br><span class="line"></span><br><span class="line">for k,v in D.items():</span><br><span class="line">    print(k,v)</span><br><span class="line"></span><br><span class="line">isinstance([1,2,3], Iterable) //True</span><br><span class="line">isinstance(&#123;&apos;k&apos;:&apos;v&apos;&#125;, Iterable) //True</span><br><span class="line">isinstance(&apos;abc&apos;, Iterable) //True</span><br><span class="line">isinstance(123, Iterable) //False</span><br></pre></td></tr></table></figure><h3 id="列表生成器"><a href="#列表生成器" class="headerlink" title="列表生成器"></a>列表生成器</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">list(range(1,6)) //[1,2,3,4,5] 前闭后开</span><br><span class="line"></span><br><span class="line">[x*x for x in range(1,6)] //[1,4,9,16,25]</span><br><span class="line">[x*x for x in range(1,6) if x%2==0] //[4,16]</span><br><span class="line">[x+y for x in &apos;abc&apos; for y in &apos;123&apos;] //[&apos;a1&apos;, a2&apos;,&apos;a3&apos;,&apos;b1&apos;,&apos;b2&apos;,&apos;b3&apos;,&apos;c1&apos;,&apos;c2&apos;,&apos;c3&apos;]</span><br><span class="line"></span><br><span class="line">D=&#123;&apos;a&apos;:&apos;A&apos;,&apos;b&apos;:&apos;B&apos;&#125;</span><br><span class="line">[k+&apos;=&apos;+v for k,v in D.items()] //[&apos;a=A&apos;,&apos;b=B&apos;]</span><br><span class="line">L=[&apos;Hello&apos;, &apos;World&apos;]</span><br><span class="line">[str.lower() for str in L] //[&apos;hello&apos;,&apos;world&apos;]</span><br></pre></td></tr></table></figure><h3 id="生成器"><a href="#生成器" class="headerlink" title="生成器"></a>生成器</h3><ul><li>生成器, 一边循环一边计算的机制, 节省内存空间</li><li>函数中包含yield关键字, 该函数不是普通函数而是generator生成器. 每次调用next()遇到yield返回, 再次next()调用继续执行<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">L=[x*x for x in range(6)] //[0,1,4,9,16,25]</span><br><span class="line">G=(x*x for x in range(6)) </span><br><span class="line">G //&lt;generator object &lt;genexpr&gt; at 0x7fa8c00dd7c8&gt;</span><br><span class="line">next(G) //0</span><br><span class="line">next(G) //1</span><br><span class="line">next(G) //4</span><br><span class="line">next(G) //9</span><br><span class="line">next(G) //16</span><br><span class="line">next(G) //25</span><br><span class="line">next(G) //StopIteration异常</span><br><span class="line"></span><br><span class="line">def fib(max):</span><br><span class="line">    n,a,b=0,0,1</span><br><span class="line">    while n&lt;max:</span><br><span class="line">        yield b</span><br><span class="line">        a,b=b,a+b</span><br><span class="line">        n=n+1</span><br><span class="line">    return &apos;done&apos;</span><br></pre></td></tr></table></figure></li></ul><h3 id="迭代器"><a href="#迭代器" class="headerlink" title="迭代器"></a>迭代器</h3><ul><li>凡是可作用于for循环的对象都是Iterable类型；</li><li>凡是可作用于next()函数的对象都是Iterator类型，它们表示一个惰性计算的序列；</li><li>集合数据类型如list、dict、str等是Iterable但不是Iterator，不过可以通过iter()函数获得一个Iterator对象。</li><li>Python的for循环本质上就是通过不断调用next()函数实现的<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">it = iter([1,2,3])</span><br><span class="line">while　True:</span><br><span class="line">    try:</span><br><span class="line">        x=next(it)</span><br><span class="line">    exception StopIteration:</span><br><span class="line">        break</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;切片&quot;&gt;&lt;a href=&quot;#切片&quot; class=&quot;headerlink&quot; title=&quot;切片&quot;&gt;&lt;/a&gt;切片&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;截取list或tuple的部分元素&lt;/li&gt;
&lt;li&gt;截取字符串元素&lt;figure class=&quot;highlight plain
      
    
    </summary>
    
    
      <category term="python" scheme="http://github.com/categories/python/"/>
    
    
  </entry>
  
  <entry>
    <title>python-02-函数</title>
    <link href="http://github.com/2018/09/11/python-02-%E5%87%BD%E6%95%B0/"/>
    <id>http://github.com/2018/09/11/python-02-函数/</id>
    <published>2018-09-11T12:53:41.000Z</published>
    <updated>2019-09-22T09:17:32.668Z</updated>
    
    <content type="html"><![CDATA[<h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><p>借助抽象, 不用关心底层具体计算过程, 直接思考高层次问题．函数是最基本的一种代码抽象方式．</p><ul><li><p>调用函数<br>函数名, 指向一个函数对象的引用, 完全可以把函数名赋给一个变量, 相当于给函数起别名．</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">aaa=abs</span><br><span class="line">aaa(-666) //666, 调用abs()函数</span><br></pre></td></tr></table></figure></li><li><p>定义函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">def my_fun(x):</span><br><span class="line">    if x &gt;=0:</span><br><span class="line">        return x</span><br><span class="line">    else:</span><br><span class="line">        return -x</span><br></pre></td></tr></table></figure></li><li><p>空函数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&apos;# pass实际可以用来作为占位符</span><br><span class="line">def nop():</span><br><span class="line">    pass</span><br></pre></td></tr></table></figure></li><li><p>返回多个值</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">def move(x,y,step):</span><br><span class="line">    nx=x+step</span><br><span class="line">    ny=y+step</span><br><span class="line">    return nx,ny</span><br><span class="line"></span><br><span class="line">x,y=move(5,5,1)</span><br><span class="line">print(x,y) //6,6</span><br><span class="line"></span><br><span class="line">z=move(4,4,2)</span><br><span class="line">print(z) //(6,6),返回元组tuple</span><br></pre></td></tr></table></figure></li><li><p>位置参数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">def test(x,y,z):</span><br><span class="line">    print(x,y,z)</span><br><span class="line"></span><br><span class="line">test(1,2,3)</span><br></pre></td></tr></table></figure></li><li><p>默认参数</p></li></ul><p>1.必选参数在前, 默认参数在后(思考: 为什么默认参数不能在必选参数之前?);<br>2.当函数有多个参数时，把变化大的参数放前面，变化小的参数放后面。变化小的参数就可以作为默认参数。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">def test(x,y=2):</span><br><span class="line">    print(x,y)</span><br><span class="line"></span><br><span class="line">test(1)</span><br><span class="line">test(1,2)</span><br><span class="line">test(1,3)</span><br></pre></td></tr></table></figure><ul><li>可变参数</li></ul><p>1.允许传入0个或多个参数, 可变参数在函数调用时自动组装为一个tuple</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">def test(*numbers):</span><br><span class="line">    for n in numbers:</span><br><span class="line">        print(n)</span><br><span class="line"></span><br><span class="line">test(1,2,3)</span><br><span class="line">test([1,2,3])</span><br><span class="line">test((1,2,3,4))</span><br><span class="line">test()</span><br><span class="line">test(*nums) //nums为一个list或tuple</span><br></pre></td></tr></table></figure><ul><li>关键字参数</li></ul><p>1.允许传入0个或多个参数名的参数, 关键字参数在函数内部自动组装为一个dict<br>2.kw获得外部dict的一份拷贝, kw的改动不影响函数外的外部dict</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">def test(x,y,**kw):</span><br><span class="line">    print(x,y,kw)</span><br><span class="line"></span><br><span class="line">test(1,2) //1 2 &#123;&#125;</span><br><span class="line">test(1,2,&apos;k1&apos;:&apos;v1&apos;) //1 2 &#123;&apos;k1&apos;:&apos;v1&apos;&#125;</span><br></pre></td></tr></table></figure><ul><li>命名关键字参数</li></ul><p>1.命名关键字参数必须传入参数名, 否则报错</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">def test(x,y,*,z):</span><br><span class="line">    print(x,y,z)</span><br><span class="line"></span><br><span class="line">test(1,2,z=3)</span><br><span class="line"></span><br><span class="line">def test(x,y,*,z=3,a):</span><br><span class="line">    print(x,y,z,a)</span><br><span class="line"></span><br><span class="line">test(1,2,a=4)</span><br></pre></td></tr></table></figure><ul><li>组合参数</li></ul><p>1.参数定义的顺序必须是: 必选参数,默认参数,可变参数,命名关键字参数,关键字参数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">def test(a,b,c=0,*args,**kw):</span><br><span class="line">    print(a,b,c,args,kw)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def test(a,b,c=0,*,**kw):</span><br><span class="line">    print(a,b,c,kw)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;函数&quot;&gt;&lt;a href=&quot;#函数&quot; class=&quot;headerlink&quot; title=&quot;函数&quot;&gt;&lt;/a&gt;函数&lt;/h3&gt;&lt;p&gt;借助抽象, 不用关心底层具体计算过程, 直接思考高层次问题．函数是最基本的一种代码抽象方式．&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;调用函数&lt;br
      
    
    </summary>
    
    
      <category term="python" scheme="http://github.com/categories/python/"/>
    
    
  </entry>
  
  <entry>
    <title>python-01-基础</title>
    <link href="http://github.com/2018/09/11/python-01-%E5%9F%BA%E7%A1%80/"/>
    <id>http://github.com/2018/09/11/python-01-基础/</id>
    <published>2018-09-11T11:26:41.000Z</published>
    <updated>2019-09-21T16:43:55.375Z</updated>
    
    <content type="html"><![CDATA[<h3 id="number"><a href="#number" class="headerlink" title="number"></a>number</h3><ul><li>number:数字类型不允许改变　var = 666 或者　var1=var2=666</li><li>若改变数字数据类型的值, 将重新分配内存空间. del var 或者　del var1, var2</li><li>数字类型: 整型Int/浮点型float/复数complex/布尔bool</li><li>数字类型转换:　int(x)/float(x)/complex(x)/complex(x,y)</li><li>数字运算: +-*/(除法得浮点数)//(除法取整数)</li><li>数学函数(略)</li></ul><h3 id="string-amp-unicode"><a href="#string-amp-unicode" class="headerlink" title="string &amp; unicode"></a>string &amp; unicode</h3><ul><li><p>str: 字符串类型不允许改变　str=’tiny’ 或者　str=”tiny”</p></li><li><p>不支持单字符类型, 单字符也是字符串</p></li><li><p>+拼接/*重复/[]索引字符/[:]截取/[not]in成员/r原始字符串/%格式字符串</p></li><li><p>ASCII编码 1个字节</p></li><li><p>Unicode编码 2个字节</p></li><li><p>UTF-8编码 英文1个字节,中文3个字节</p></li><li><p>内存中, 统一使用unicode编码, 存储或传输时建议统一使用utf-8;</p></li><li><p>以unicode编码的str, 通过encode()编码指定的bytes:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&apos;abc&apos;.encode(&apos;ascii&apos;)</span><br><span class="line">&apos;abc&apos;.encode(&apos;utf-8&apos;)</span><br><span class="line">&apos;中文&apos;.encode(&apos;utf-8&apos;)</span><br><span class="line">&apos;中文&apos;.encode(&apos;ascii&apos;)报错, 中文编码范围超过了ascii编码范围</span><br></pre></td></tr></table></figure></li><li><p>len()函数计算str的”字符数”!</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">len(b&apos;abc&apos;)  //3</span><br><span class="line">len(b&apos;\xe4\xb8\xad\xe6\x96\x87&apos;) //6</span><br><span class="line">len(&apos;中文&apos;) //2</span><br><span class="line">len(&apos;中文&apos;.encode(&apos;utf-8&apos;)) //6</span><br></pre></td></tr></table></figure></li></ul><h3 id="list-amp-tuple"><a href="#list-amp-tuple" class="headerlink" title="list &amp; tuple"></a>list &amp; tuple</h3><p>list, 有序列表集合, 可添加删除元素</p><ul><li>声明: alist=[‘tiny’, ‘jack’, ‘rose’, 100, True]</li><li>获取元素个数: len(alist)</li><li>索引(更新): alist[0] 或者 alist[-1] 或者alist[0]=’ttcn’</li><li>末尾追加: alist.append(‘marry’)</li><li>指定插入: alist.insert(1, ‘adam’)</li><li>末尾删除: alist.pop() 返回元素内容</li><li>指定删除: alist.pop(1) 返回元素内容</li><li>list 可包含不同数据类型 [True, 999, ‘str’]</li><li>list 可包含list [‘test’, [1,2,3], ‘python’]</li></ul><p>tuple, 有序列表元组, 不可修改!</p><ul><li>声明: atuple=(‘one’,) 或者 atuple=(‘one’, ‘two’, ‘three’)</li><li>tuple ‘指向不变’, 因此 atuple=(‘one’, [1,2]);atuple[1][0]=2; 是允许的</li></ul><h3 id="set-amp-dict"><a href="#set-amp-dict" class="headerlink" title="set &amp; dict"></a>set &amp; dict</h3><p>set, 无序不可重复集合, 可添加删除元素</p><ul><li>声明: aset=set(‘abc’) 或 aset=set([1,2,3]) 或　aset=set() 或 aset={1,2,3} (不能使用空{})</li><li>获取元素个数: len(aset)</li><li>添加元素: aset.add(x)</li><li>更新元素: aset.update(x) 或 aset.update({1,2,3}) 或　aset.update([1,2],[3,4])</li><li>删除元素: aset.remove(x), 没有该元素则发生错误</li><li>删除元素: aset.discard(x), 没有该元素则不会发生错误</li><li>随机删除元素: aset.pop()</li><li>清空集合: aset.clear()</li><li>判断元素存在: x in aset</li></ul><p>dict, 字典存储任意类型对象, 可添加删除元素</p><ul><li>声明: adict={k1:v1, k2:v2} 或　adict={}</li><li>获取元素个数: len(adict)</li><li>键必须唯一, 不可变, 如数字/字符串/元组</li><li>获取元素: adict[k1]</li><li>更新元素: adict[k1]=’new_value’</li><li>删除元素: del adict[k1]</li><li>随机删除元素: adict.popitem()</li><li>指定删除元素: adict.pop(k1[,default]), 没有该元素则返回default</li><li>清空字典: adict.clear()</li><li>删除字典: del adict</li><li>判断key存在: k1 in adict</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;number&quot;&gt;&lt;a href=&quot;#number&quot; class=&quot;headerlink&quot; title=&quot;number&quot;&gt;&lt;/a&gt;number&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;number:数字类型不允许改变　var = 666 或者　var1=var2=666&lt;/li&gt;
      
    
    </summary>
    
    
      <category term="python" scheme="http://github.com/categories/python/"/>
    
    
  </entry>
  
  <entry>
    <title>django-01-基础</title>
    <link href="http://github.com/2018/03/25/django-01-%E5%9F%BA%E7%A1%80/"/>
    <id>http://github.com/2018/03/25/django-01-基础/</id>
    <published>2018-03-25T07:41:25.000Z</published>
    <updated>2019-09-22T09:32:11.114Z</updated>
    
    <content type="html"><![CDATA[<h2 id="django-01"><a href="#django-01" class="headerlink" title="django 01"></a>django 01</h2><ul><li><p>安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">source /path/to/ENV/bin/activate //进入虚拟环境</span><br><span class="line">pip3 install Django //安装Django</span><br><span class="line">python</span><br><span class="line">import django</span><br><span class="line">print(django.get_version())</span><br><span class="line">2.1.7 //验证django版本</span><br></pre></td></tr></table></figure></li><li><p>创建一个django项目</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mkdir /path/to/your-project</span><br><span class="line">cd /path/to/your-project</span><br><span class="line">django-admin startproject tinyproject</span><br><span class="line">tree -L 3</span><br><span class="line">tinyproject/  //根目录只是你项目的容器， Django 不关心它的名字</span><br><span class="line">├── manage.py //一个让你用各种方式管理 Django 项目的命令行工具</span><br><span class="line">└── mysite</span><br><span class="line">    ├── __init__.py</span><br><span class="line">    ├── settings.py //Django 项目的配置文件</span><br><span class="line">    ├── urls.py     //Django 项目的 URL 声明, URL调度器</span><br><span class="line">    └── wsgi.py     //作为你的项目的运行在 WSGI 兼容的Web服务器上的入口</span><br></pre></td></tr></table></figure></li><li><p>创建一个django应用</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">python manage.py startapp polls //一个项目的一个应用</span><br><span class="line">tree -L 3 polls</span><br><span class="line">polls/</span><br><span class="line">├── admin.py</span><br><span class="line">├── apps.py</span><br><span class="line">├── __init__.py</span><br><span class="line">├── migrations</span><br><span class="line">│   └── __init__.py</span><br><span class="line">├── models.py</span><br><span class="line">├── tests.py</span><br><span class="line">└── views.py</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;django-01&quot;&gt;&lt;a href=&quot;#django-01&quot; class=&quot;headerlink&quot; title=&quot;django 01&quot;&gt;&lt;/a&gt;django 01&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;安装&lt;/p&gt;
&lt;figure class=&quot;highlight p
      
    
    </summary>
    
    
      <category term="django" scheme="http://github.com/categories/django/"/>
    
    
  </entry>
  
  <entry>
    <title>emacs-fix-startup-slow</title>
    <link href="http://github.com/2018/03/09/emacs-fix-startup-slow/"/>
    <id>http://github.com/2018/03/09/emacs-fix-startup-slow/</id>
    <published>2018-03-09T02:45:08.000Z</published>
    <updated>2019-09-21T16:43:55.374Z</updated>
    
    <content type="html"><![CDATA[<p>问题: spacemacs 启动速度较慢, 可能长达几十秒. 正常速度应该在十多秒甚至几秒.</p><p>分析: 启动时, 需要loading 不同layer 的配置el文件.</p><p>解决: </p><ol><li>Messages buffer 中查看loading信息, 查看是否有异常信息;</li><li>命令行启动, 查看cpu和内存信息;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">emacs --profiles 或 emacs.exe --profiles</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">3. 命令行启动, 查看需要的时间信息;(最为直观);</span><br></pre></td></tr></table></figure></li></ol><p>emcas –timed-requires 或 emcas.exe –timed-requires</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">4. 删除不必要的layer</span><br><span class="line">5. 在melpa检查包更新也很耗时;</span><br><span class="line">6. 检查spacemacs版本也是没那么必要, 除非你喜欢保持最新版.</span><br><span class="line"></span><br><span class="line">测试: </span><br><span class="line">- 测试机器surface pro 4 i5 windows10 gnu emacs 启动速度4~5s</span><br><span class="line"></span><br><span class="line">我的配置文件:</span><br></pre></td></tr></table></figure><p>dotspacemacs-configuration-layers<br>   ‘(<br>     html<br>     ;; —————————————————————-<br>     ;; Example of useful layers you may want to use right away.<br>     ;; Uncomment some layer names and press <spc f e r> (Vim style) or<br>     ;; <m-m f e r> (Emacs style) to install them.<br>     ;; —————————————————————-<br>     helm<br>     auto-completion<br>     better-defaults<br>     emacs-lisp<br>     ;; git<br>     markdown<br>     org<br>     syntax-checking<br>     ;; version-control<br>     )<br>   ;</m-m></spc></p><pre><code></code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;问题: spacemacs 启动速度较慢, 可能长达几十秒. 正常速度应该在十多秒甚至几秒.&lt;/p&gt;
&lt;p&gt;分析: 启动时, 需要loading 不同layer 的配置el文件.&lt;/p&gt;
&lt;p&gt;解决: &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Messages buffer 中查看loa
      
    
    </summary>
    
    
      <category term="emacs" scheme="http://github.com/categories/emacs/"/>
    
    
  </entry>
  
  <entry>
    <title>emacs-evil-vim-keymap</title>
    <link href="http://github.com/2018/03/06/emacs-evil-vim-keymap/"/>
    <id>http://github.com/2018/03/06/emacs-evil-vim-keymap/</id>
    <published>2018-03-06T14:25:20.000Z</published>
    <updated>2019-09-21T16:43:55.372Z</updated>
    
    <content type="html"><![CDATA[<p>以下type 键位, 均位于normal state.</p><h2 id="1-光标移动"><a href="#1-光标移动" class="headerlink" title="1 光标移动 "></a>1 光标移动 </h2><ol><li>光标移动 hjkl </li><li>移动到buffer开头 gg</li><li>移动到buffer结尾 G</li><li>移动到下n个word [number] w</li><li>移动到下n个word的结尾 [number] e</li><li>移动到下n个word的开头 [number] b</li></ol><h2 id="2-插入文本-增"><a href="#2-插入文本-增" class="headerlink" title="2 插入文本 (增)"></a>2 插入文本 (增)</h2><ol><li>光标前插入 i </li><li>光标后插入 a </li><li>光标上一行插入 O</li><li>光标下一行插入 o </li><li>光标行首插入 I</li><li>光标行尾插入 A </li></ol><h2 id="3-删除文本-删"><a href="#3-删除文本-删" class="headerlink" title="3 删除文本 (删)"></a>3 删除文本 (删)</h2><ol><li>光标下删除一个字符 x </li><li>光标往后删除一个单词 dw</li><li>光标往后删除一行 d$ 或 D </li><li>光标下一整行 dd</li><li>delete command格式:<br>[number] command object 或 command [number] object<br>2dw 或 d2w<br>2dd 或 d2d</li></ol><h2 id="4-修改文本-删改"><a href="#4-修改文本-删改" class="headerlink" title="4 修改文本 (删改)"></a>4 修改文本 (删改)</h2><p>注意的是: 修改时, normal state &gt;&gt; insert state </p><ol><li>光标下修改一个字符 r (自动esc退出insert state)</li><li>光标下连续修改 R (直到esc退出)</li><li>光标往后修改一个单词 cw (直到esc退出) </li><li>光标往后修改一个行 c$ (直到esc退出)</li><li>change command格式:<br>[number] command object 或 command [number] object </li></ol><h2 id="5-替换文本-换改"><a href="#5-替换文本-换改" class="headerlink" title="5 替换文本 (换改)"></a>5 替换文本 (换改)</h2><ol><li>当前行替换一次 :s/old/new</li><li>当前行替换n次  :s/old/new/g </li><li>某几行替换一次 :s#,#/old/new/g </li><li>全部替换      :%s/old/new/g </li><li>全部替换(每次改变有提示) :%s/old/new/gc </li></ol><h2 id="6-搜索文本-查"><a href="#6-搜索文本-查" class="headerlink" title="6 搜索文本 (查)"></a>6 搜索文本 (查)</h2><ol><li>正向搜索 / (n 下一个匹配项 N 上一个匹配项)</li><li>反向搜索 ? (n 下一个匹配项 N 上一个匹配项)</li><li>定位配对符号 % (定位(),[],{})</li></ol><h2 id="7-命令行"><a href="#7-命令行" class="headerlink" title="7 命令行"></a>7 命令行</h2><ol><li>外部命令行格式 :!command<br>:!ls or :!dir          列出目录<br>:!rm or :!del FILENAME 删除文件<br>:w FILENAME            当前buffer全部内容写出到文件FILENAME<br>:#,#w FILENAME         当前buffer某行内容写出到文件FILENAME<br>:r FILENAME            从文件FILENAME恢复内容到当前buffer</li></ol><h2 id="8-复制-粘贴"><a href="#8-复制-粘贴" class="headerlink" title="8 复制 粘贴"></a>8 复制 粘贴</h2><p>normal模式下:</p><ol><li>yw</li><li>yy</li><li>y$</li><li>y^</li><li>:reg 粘贴板</li><li>“ayw 复制到a粘贴板栈中, “ap 粘贴从a粘贴板栈中. </li></ol><p>按字符选择模式:</p><ol><li>v (visual state)</li><li>hjkl</li><li>y (yank)</li><li>hjkl</li><li>p (put)</li></ol><p>按行选择模式:</p><ol><li>V (visual state)</li><li>hjkl</li><li>y</li><li>hjkl</li><li>p</li></ol><p>按块选择模式:</p><ol><li>CTRL-v (visual state)</li><li>hjkl</li><li>y</li><li>hjkl</li><li>p</li></ol><h2 id="9-剪切-粘贴"><a href="#9-剪切-粘贴" class="headerlink" title="9 剪切 粘贴"></a>9 剪切 粘贴</h2><p>同上 复制粘贴</p><ol><li>v (visual state)</li><li>hjkl </li><li>d (delete)</li><li>hjkl</li><li>p (put)</li></ol><h2 id="10-退出-保存"><a href="#10-退出-保存" class="headerlink" title="10 退出 保存"></a>10 退出 保存</h2><ol><li>退出 :q</li><li>退出不保存 :q!</li><li>保存 :w</li><li>保存 另存为 :w filename.md </li><li>退出保存 :wq 或 :x 或 ZZ</li></ol><h2 id="11-切换模式"><a href="#11-切换模式" class="headerlink" title="11 切换模式"></a>11 切换模式</h2><ol><li>退回正常模式 ESC 或 CTRL-[</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;以下type 键位, 均位于normal state.&lt;/p&gt;
&lt;h2 id=&quot;1-光标移动&quot;&gt;&lt;a href=&quot;#1-光标移动&quot; class=&quot;headerlink&quot; title=&quot;1 光标移动 &quot;&gt;&lt;/a&gt;1 光标移动 &lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;光标移动 hjkl &lt;
      
    
    </summary>
    
    
      <category term="emacs" scheme="http://github.com/categories/emacs/"/>
    
    
  </entry>
  
  <entry>
    <title>emacs-evil-vim-tutor</title>
    <link href="http://github.com/2018/03/05/emacs-evil-vim-tutor/"/>
    <id>http://github.com/2018/03/05/emacs-evil-vim-tutor/</id>
    <published>2018-03-05T15:10:52.000Z</published>
    <updated>2019-09-21T16:43:55.373Z</updated>
    
    <content type="html"><![CDATA[<h2 id="lesson-1"><a href="#lesson-1" class="headerlink" title="lesson 1"></a>lesson 1</h2><p>移动 插入 删除 保存  </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. 光标移动, hjkl</span><br><span class="line">2. 退出emacs, &lt;ESC&gt; :qa! &lt;ENTER&gt; 放弃修改退出</span><br><span class="line">3. 退出emacs, &lt;ESC&gt; :wqa &lt;ENTER&gt; 保存修改退出</span><br><span class="line">4. 删除一个字符, normal状态下 x </span><br><span class="line">5. 插入文本, normal状态下 i 插入文本 &lt;ESC&gt;</span><br></pre></td></tr></table></figure><h2 id="lesson-2"><a href="#lesson-2" class="headerlink" title="lesson 2"></a>lesson 2</h2><p>删除 撤销</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1. 删除往后的一个单词, dw</span><br><span class="line">2. 删除往后的一行, d$</span><br><span class="line">3. 删除整行, dd</span><br><span class="line">4. command格式: </span><br><span class="line">[number] command object</span><br><span class="line">command [number] object</span><br><span class="line">5. 往前撤销 u</span><br><span class="line">6. 往后撤销 C-R</span><br></pre></td></tr></table></figure><h2 id="lesson-3"><a href="#lesson-3" class="headerlink" title="lesson 3"></a>lesson 3</h2><p>放置 替换 修改(改变)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1. 放置已删除的文本, p (放置光标之后)</span><br><span class="line">2. 替换一个字符, r </span><br><span class="line">3. 改变command, cw (改变往后一个单词) c$ (改变往后一行) </span><br><span class="line">4. 改变command格式: </span><br><span class="line">[number] c object</span><br><span class="line">c [number] object</span><br></pre></td></tr></table></figure><h2 id="lesson-4"><a href="#lesson-4" class="headerlink" title="lesson 4"></a>lesson 4</h2><p>移动 搜索内容 替换内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">1. 移动到buffer开头, gg</span><br><span class="line">2. 移动到buffer结尾, G</span><br><span class="line">3. 移动到某行, :[number]</span><br><span class="line">4. 正向搜索短语, / (n 下一个匹配项 N上一个匹配项)</span><br><span class="line">5. 反向搜索短语, ? (n 下一个匹配项 N上一个匹配项)</span><br><span class="line">6. 定位配对符号, % (包括(),[],&#123;&#125;)</span><br><span class="line">7. 替换 :s/old/new </span><br><span class="line">8. 替换 :s/old/new/g </span><br><span class="line">9. 替换某几行间 :#,#s/old/new/g (:96,106s/old/new/g)</span><br><span class="line">10. 替换全部 :%s/old/new/g</span><br><span class="line">11. To ask for confirmation each time add &apos;c&apos; </span><br><span class="line">:%s/old/new/gc</span><br></pre></td></tr></table></figure><h2 id="lesson-5"><a href="#lesson-5" class="headerlink" title="lesson 5"></a>lesson 5</h2><p>命令行 移动内容/恢复内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1. 外部命令行, :!command </span><br><span class="line">:!ls or :!dir 列出目录</span><br><span class="line">:!rm or :!del &lt;filename&gt; 删除文件 </span><br><span class="line">2. 当前buffer内容写出到文件 :w &lt;filename&gt;</span><br><span class="line">3. 当前某行间内容写出到文件  :#,#w &lt;filename&gt; </span><br><span class="line">4. 从文件恢复内容到当前buffer :r &lt;filename&gt;</span><br></pre></td></tr></table></figure><h2 id="lesson-6"><a href="#lesson-6" class="headerlink" title="lesson 6"></a>lesson 6</h2><p>插入 替换 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. 光标下一行, 插入文本 o</span><br><span class="line">2. 光标上一行, 插入文本 O (大写o)</span><br><span class="line">3. 光标之后, 插入文本 a </span><br><span class="line">4. 行末尾, 插入文本 A </span><br><span class="line">5. 持续替换直到&lt;ESC&gt; R</span><br></pre></td></tr></table></figure><p>end.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;lesson-1&quot;&gt;&lt;a href=&quot;#lesson-1&quot; class=&quot;headerlink&quot; title=&quot;lesson 1&quot;&gt;&lt;/a&gt;lesson 1&lt;/h2&gt;&lt;p&gt;移动 插入 删除 保存  &lt;/p&gt;
&lt;figure class=&quot;highlight pla
      
    
    </summary>
    
    
      <category term="emacs" scheme="http://github.com/categories/emacs/"/>
    
    
  </entry>
  
  <entry>
    <title>09_project_PowerDesigner</title>
    <link href="http://github.com/2018/02/26/09-project-PowerDesigner/"/>
    <id>http://github.com/2018/02/26/09-project-PowerDesigner/</id>
    <published>2018-02-26T14:18:36.000Z</published>
    <updated>2019-09-21T16:43:55.331Z</updated>
    
    <content type="html"><![CDATA[<h2 id="power-designer"><a href="#power-designer" class="headerlink" title="power designer"></a>power designer</h2><p>#特点#</p><ul><li>数据建模软件, 通过图形化界面展现建模</li><li>自动生成数据库建库语句</li><li>可选择不同类型数据建模</li></ul><p>#使用#</p><ol start="0"><li>Model types &gt; Physical Data Model &gt; Physical Diagram</li><li>选择数据库DBMS: mysql5.0</li><li>Column标签, 创建表 (可开启备注: 工具&gt;勾选Comment), 自定义字段信息</li><li>Columns标签, 主键自增设定(第一列箭头选中,双击,勾选indentity)</li><li>Preview标签, 预览建表语句(粘贴至SqlYog中执行, 建表即可)</li></ol><p>#关联关系#</p><ol><li>选中Referece工具, 指定关联关系即可.</li><li>自关联的情况下, 修改关联关系(ParentTableColumn:主键/ChildTableColumn:外键)</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;power-designer&quot;&gt;&lt;a href=&quot;#power-designer&quot; class=&quot;headerlink&quot; title=&quot;power designer&quot;&gt;&lt;/a&gt;power designer&lt;/h2&gt;&lt;p&gt;#特点#&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;数据建模
      
    
    </summary>
    
    
      <category term="mysql" scheme="http://github.com/categories/mysql/"/>
    
    
  </entry>
  
</feed>
